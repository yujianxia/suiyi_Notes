(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{437:function(t,s,a){"use strict";a.r(s);var n=a(25),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"_1-跨标签页通讯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-跨标签页通讯"}},[t._v("#")]),t._v(" "),a("strong",[t._v("1. 跨标签页通讯")])]),t._v(" "),a("p",[t._v("不同标签页间的通讯，本质原理就是去运用一些可以 "),a("strong",[t._v("共享的中间介质")]),t._v("，因此比较常用的有以下方法:")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("通过父页面"),a("code",[t._v("window.open()")]),t._v("和子页面"),a("code",[t._v("postMessage")])]),t._v(" "),a("ul",[a("li",[t._v("异步下，通过 "),a("code",[t._v("window.open('about: blank')")]),t._v(" 和 "),a("code",[t._v("tab.location.href = '*'")])])])]),t._v(" "),a("li",[a("p",[t._v("设置同域下共享的"),a("code",[t._v("localStorage")]),t._v("与监听"),a("code",[t._v("window.onstorage")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("重复写入相同的值无法触发")])]),t._v(" "),a("li",[a("p",[t._v("会受到浏览器隐身模式等的限制")])])])]),t._v(" "),a("li",[a("p",[t._v("监听localStorage变化")])])]),t._v(" "),a("p",[a("strong",[t._v("当同源页面的某个页面修改了"),a("code",[t._v("localStorage")]),t._v("，其余的同源页面只要注册了storage事件，就会触发")])]),t._v(" "),a("p",[t._v("所以，"),a("code",[t._v("localStorage")]),t._v(" 的例子运行需要如下条件：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("同一浏览器打开了两个同源页面")])]),t._v(" "),a("li",[a("p",[t._v("其中一个网页修改了 "),a("code",[t._v("localStorage")])])]),t._v(" "),a("li",[a("p",[t._v("另一网页注册了 "),a("code",[t._v("storage")]),t._v(" 事件")])])]),t._v(" "),a("blockquote",[a("p",[a("strong",[t._v("很容易犯的错误是，在同一个网页修改本地存储，又在同一个网页监听，这样是没有效果的。")])])]),t._v(" "),a("ol",[a("li",[t._v("在同源的两个页面中，可以监听 "),a("code",[t._v("storage")]),t._v(" 事件")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"storage"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[a("a",{attrs:{"data-fancybox":"",title:"结果示例",href:"/notes/assets/browser/1616484269(1).jpg"}},[a("img",{attrs:{src:"/notes/assets/browser/1616484269(1).jpg",alt:"结果示例"}})])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" orignalSetItem "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" localStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("setItem"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nlocalStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("setItem")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("newValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" setItemEvent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"setItemEvent"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      setItemEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("newValue "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatchEvent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("setItemEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("orignalSetItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("arguments"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nwindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"setItemEvent"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("newValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nlocalStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wang"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("p",[a("a",{attrs:{"data-fancybox":"",title:"结果示例",href:"/notes/assets/browser/1616484377(1).jpg"}},[a("img",{attrs:{src:"/notes/assets/browser/1616484377(1).jpg",alt:"结果示例"}})])]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("在同一个页面中，对 "),a("code",[t._v("localStorage")]),t._v(" 的 "),a("code",[t._v("setItem")]),t._v(" 方法进行重写")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("设置共享"),a("code",[t._v("cookie")]),t._v("与不断轮询脏检查("),a("code",[t._v("setInterval")]),t._v(")")])]),t._v(" "),a("li",[a("p",[t._v("借助服务端或者中间层实现")])])]),t._v(" "),a("h2",{attrs:{id:"_2-浏览器架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-浏览器架构"}},[t._v("#")]),t._v(" "),a("strong",[t._v("2. 浏览器架构")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("用户界面")])]),t._v(" "),a("li",[a("p",[t._v("主进程")])]),t._v(" "),a("li",[a("p",[t._v("内核")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("渲染引擎")])]),t._v(" "),a("li",[a("p",[t._v("JS 引擎")]),t._v(" "),a("ul",[a("li",[t._v("执行栈")])])]),t._v(" "),a("li",[a("p",[t._v("事件触发线程")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("消息队列")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("微任务")])]),t._v(" "),a("li",[a("p",[t._v("宏任务")])])])])])]),t._v(" "),a("li",[a("p",[t._v("网络异步线程")])]),t._v(" "),a("li",[a("p",[t._v("定时器线程")])])])])]),t._v(" "),a("h2",{attrs:{id:"_3-浏览器下事件循环-event-loop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-浏览器下事件循环-event-loop"}},[t._v("#")]),t._v(" "),a("strong",[t._v("3. 浏览器下事件循环(Event Loop)")])]),t._v(" "),a("p",[t._v("事件循环是指: 执行一个宏任务，然后执行清空微任务列表，循环再执行宏任务，再清微任务列表")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("微任务 "),a("code",[t._v("microtask(jobs)")]),t._v(": "),a("code",[t._v("promise")]),t._v(" / "),a("code",[t._v("ajax")]),t._v(" / "),a("code",[t._v("Object.observe(该方法已废弃)")])])]),t._v(" "),a("li",[a("p",[t._v("宏任务 "),a("code",[t._v("macrotask(task)")]),t._v(": "),a("code",[t._v("setTimout")]),t._v(" / "),a("code",[t._v("script")]),t._v(" / "),a("code",[t._v("IO")]),t._v(" / "),a("code",[t._v("UI Rendering")])])])]),t._v(" "),a("h2",{attrs:{id:"_4-从输入-url-到展示的过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-从输入-url-到展示的过程"}},[t._v("#")]),t._v(" "),a("strong",[t._v("4. 从输入 url 到展示的过程")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("DNS 解析")])]),t._v(" "),a("li",[a("p",[t._v("TCP 三次握手")])]),t._v(" "),a("li",[a("p",[t._v("发送请求，分析 url，设置请求报文(头，主体)")])]),t._v(" "),a("li",[a("p",[t._v("服务器返回请求的文件 (html)")])]),t._v(" "),a("li",[a("p",[t._v("浏览器渲染")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("HTML parser --\x3e DOM Tree")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("标记化算法，进行元素状态的标记")])]),t._v(" "),a("li",[a("p",[t._v("dom 树构建")])])])]),t._v(" "),a("li",[a("p",[t._v("CSS parser --\x3e Style Tree")]),t._v(" "),a("ul",[a("li",[t._v("解析 css 代码，生成样式树")])])]),t._v(" "),a("li",[a("p",[t._v("attachment --\x3e Render Tree")]),t._v(" "),a("ul",[a("li",[t._v("结合 dom树 与 style树，生成渲染树")])])]),t._v(" "),a("li",[a("p",[t._v("layout: 布局")])]),t._v(" "),a("li",[a("p",[t._v("GPU painting: 像素绘制页面")])])])])]),t._v(" "),a("h2",{attrs:{id:"_5-重绘与回流"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-重绘与回流"}},[t._v("#")]),t._v(" "),a("strong",[t._v("5. 重绘与回流")])]),t._v(" "),a("p",[t._v("当元素的样式发生变化时，浏览器需要触发更新，重新绘制元素。这个过程中，有两种类型的操作，即重绘与回流。")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("重绘(repaint)")]),t._v(": 当元素样式的改变不影响布局时，浏览器将使用重绘对元素进行更新，此时由于只需要UI层面的重新像素绘制，因此 "),a("strong",[t._v("损耗较少")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("回流(reflow)")]),t._v(": 当元素的尺寸、结构或触发某些属性时，浏览器会重新渲染页面，称为回流。此时，浏览器需要重新经过计算，计算后还需要重新页面布局，因此是较重的操作。会触发回流的操作:")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("页面初次渲染")])]),t._v(" "),a("li",[a("p",[t._v("浏览器窗口大小改变")])]),t._v(" "),a("li",[a("p",[t._v("元素尺寸、位置、内容发生改变")])]),t._v(" "),a("li",[a("p",[t._v("元素字体大小变化")])]),t._v(" "),a("li",[a("p",[t._v("添加或者删除可见的 dom 元素")])]),t._v(" "),a("li",[a("p",[t._v("激活 CSS 伪类（例如：:hover）")])]),t._v(" "),a("li",[a("p",[t._v("查询某些属性或调用某些方法")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("clientWidth、clientHeight、clientTop、clientLeft")])]),t._v(" "),a("li",[a("p",[t._v("offsetWidth、offsetHeight、offsetTop、offsetLeft")])]),t._v(" "),a("li",[a("p",[t._v("scrollWidth、scrollHeight、scrollTop、scrollLeft")])]),t._v(" "),a("li",[a("p",[t._v("getComputedStyle()")])]),t._v(" "),a("li",[a("p",[t._v("getBoundingClientRect()")])]),t._v(" "),a("li",[a("p",[t._v("scrollTo()")])])])])])])]),t._v(" "),a("p",[a("strong",[t._v("回流必定触发重绘，重绘不一定触发回流。重绘的开销较小，回流的代价较高。")])]),t._v(" "),a("p",[a("strong",[t._v("样式总结：")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("CSS")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("避免使用"),a("code",[t._v("table")]),t._v("布局")])]),t._v(" "),a("li",[a("p",[t._v("将动画效果应用到"),a("code",[t._v("position")]),t._v("属性为"),a("code",[t._v("absolute")]),t._v("或"),a("code",[t._v("fixed")]),t._v("的元素上")])])])]),t._v(" "),a("li",[a("p",[t._v("javascript")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("避免频繁操作样式，可汇总后统一 "),a("strong",[t._v("一次修改")])])]),t._v(" "),a("li",[a("p",[t._v("尽量使用"),a("code",[t._v("class")]),t._v("进行样式修改")])]),t._v(" "),a("li",[a("p",[t._v("减少"),a("code",[t._v("dom")]),t._v("的增删次数，可使用 "),a("strong",[t._v("字符串")]),t._v(" 或者 "),a("code",[t._v("documentFragment")]),t._v(" 一次性插入")])]),t._v(" "),a("li",[a("p",[t._v("极限优化时，修改样式可将其"),a("code",[t._v("display: none")]),t._v("后修改")])]),t._v(" "),a("li",[a("p",[t._v("避免多次触发上面提到的那些会触发回流的方法，可以的话尽量用 "),a("strong",[t._v("变量存住")])])])])])]),t._v(" "),a("h2",{attrs:{id:"_6-存储"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-存储"}},[t._v("#")]),t._v(" "),a("strong",[t._v("6. 存储")])]),t._v(" "),a("p",[t._v("经常需要对业务中的一些数据进行存储，通常可以分为 短暂性存储 和 持久性储存。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("短暂性的时候，只需要将数据存在内存中，只在运行时可用")])]),t._v(" "),a("li",[a("p",[t._v("持久性存储，可以分为 浏览器端 与 服务器端")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("浏览器:")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("cookie")]),t._v(": 通常用于存储用户身份，登录状态等")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("http")]),t._v(" 中自动携带， 体积上限为 4K， 可自行设置过期时间")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("localStorage / sessionStorage")]),t._v(": 长久储存/窗口关闭删除， 体积限制为 "),a("strong",[t._v("4~5M")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("indexDB")])])])])]),t._v(" "),a("li",[a("p",[t._v("服务器:")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("分布式缓存 redis")])]),t._v(" "),a("li",[a("p",[t._v("数据库")])])])])])])]),t._v(" "),a("h2",{attrs:{id:"_7-web-worker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-web-worker"}},[t._v("#")]),t._v(" "),a("strong",[t._v("7. Web Worker")])]),t._v(" "),a("p",[t._v("现代浏览器为"),a("code",[t._v("JavaScript")]),t._v("创造的 "),a("strong",[t._v("多线程环境")]),t._v("。可以新建并将部分任务分配到"),a("code",[t._v("worker")]),t._v("线程并行运行，两个线程可 "),a("strong",[t._v("独立运行")]),t._v("，"),a("strong",[t._v("互不干扰")]),t._v("，可通过自带的 "),a("strong",[t._v("消息机制")]),t._v(" 相互通信。")]),t._v(" "),a("p",[a("strong",[t._v("基本用法:")])]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建 worker")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" worker "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Worker")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'work.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 向 worker 线程推送消息")]),t._v("\nworker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello World'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 监听 worker 线程发送过来的消息")]),t._v("\nworker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onmessage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Received message '")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br")])]),a("p",[a("strong",[t._v("限制:")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("同源限制")])]),t._v(" "),a("li",[a("p",[t._v("无法使用 "),a("code",[t._v("document")]),t._v(" / "),a("code",[t._v("window")]),t._v(" / "),a("code",[t._v("alert")]),t._v(" / "),a("code",[t._v("confirm")])])]),t._v(" "),a("li",[a("p",[t._v("无法加载本地资源")])])]),t._v(" "),a("h2",{attrs:{id:"_8-v8垃圾回收机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-v8垃圾回收机制"}},[t._v("#")]),t._v(" "),a("strong",[t._v("8. V8垃圾回收机制")])]),t._v(" "),a("p",[t._v("垃圾回收: 将内存中不再使用的数据进行清理，释放出内存空间。V8 将内存分成 "),a("strong",[t._v("新生代空间")]),t._v(" 和 "),a("strong",[t._v("老生代空间")]),t._v("。")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("新生代空间")]),t._v(": 用于存活较短的对象")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("又分成两个空间: from 空间 与 to 空间")])]),t._v(" "),a("li",[a("p",[t._v("Scavenge GC算法: 当 from 空间被占满时，启动 GC 算法")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("存活的对象从 from space 转移到 to space")])]),t._v(" "),a("li",[a("p",[t._v("清空 from space")])]),t._v(" "),a("li",[a("p",[t._v("from space 与 to space 互换")])]),t._v(" "),a("li",[a("p",[t._v("完成一次新生代GC")])])])])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("老生代空间")]),t._v(": 用于存活时间较长的对象")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("从 新生代空间 转移到 老生代空间 的条件")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("经历过一次以上 Scavenge GC 的对象")])]),t._v(" "),a("li",[a("p",[t._v("当 to space 体积超过25%")])])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("标记清除算法")]),t._v(": 标记存活的对象，未被标记的则被释放")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("增量标记: 小模块标记，在代码执行间隙执，GC 会影响性能")])]),t._v(" "),a("li",[a("p",[t._v("并发标记(最新技术): 不阻塞 js 执行")])])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("压缩算法")]),t._v(": 将内存中清除后导致的碎片化对象往内存堆的一端移动，解决 "),a("strong",[t._v("内存的碎片化")])])])])])]),t._v(" "),a("p",[a("strong",[t._v("9. 内存泄露")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("意外的"),a("strong",[t._v("全局变量")]),t._v(": 无法被回收")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("定时器")]),t._v(": 未被正确关闭，导致所引用的外部变量无法被释放")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("事件监听")]),t._v(": 没有正确销毁 (低版本浏览器可能出现)")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("闭包")]),t._v(": 会导致父级中的变量无法被释放")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("dom 引用")]),t._v(": dom 元素被删除时，内存中的引用未被正确清空")])])]),t._v(" "),a("p",[t._v("可用 chrome 中的 timeline 进行内存标记，可视化查看内存的变化情况，找出异常点。")])])}),[],!1,null,null,null);s.default=e.exports}}]);
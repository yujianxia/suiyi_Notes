(window.webpackJsonp=window.webpackJsonp||[]).push([[183],{580:function(s,t,a){"use strict";a.r(t);var n=a(25),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"webpack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webpack"}},[s._v("#")]),s._v(" Webpack")]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"_1-原理简述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-原理简述"}},[s._v("#")]),s._v(" "),a("strong",[s._v("1. 原理简述")])]),s._v(" "),a("p",[s._v("Webpack 已经成为了现在前端工程化中最重要的一环，通过"),a("code",[s._v("Webpack")]),s._v("与"),a("code",[s._v("Node")]),s._v("的配合，前端领域完成了不可思议的进步。通过预编译，将软件编程中先进的思想和理念能够真正运用于生产，让前端开发领域告别原始的蛮荒阶段。深入理解"),a("code",[s._v("Webpack")]),s._v("，可以让在编程思维及技术领域上产生质的成长，极大拓展技术边界。这也是在面试中必不可少的一个内容")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("核心概念")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("JavaScript 的 "),a("strong",[s._v("模块打包工具")]),s._v(" (module bundler)。通过分析模块之间的依赖，最终将所有模块打包成一份或者多份代码包 (bundler)，供 HTML 直接引用。实质上，Webpack 仅仅提供了 "),a("strong",[s._v("打包功能")]),s._v(" 和一套 "),a("strong",[s._v("文件处理机制")]),s._v("，然后通过生态中的各种 Loader 和 Plugin 对代码进行预编译和打包。因此 Webpack 具有高度的可拓展性，能更好的发挥社区生态的力量。")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("Entry")]),s._v(": 入口文件，Webpack 会从该文件开始进行分析与编译；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("Output")]),s._v(": 出口路径，打包后创建 bundler 的文件路径以及文件名；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("Module")]),s._v(": 模块，在 Webpack 中任何文件都可以作为一个模块，会根据配置的不同的 Loader 进行加载和打包；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("Chunk")]),s._v(": 代码块，可以根据配置，将所有模块代码合并成一个或多个代码块，以便按需加载，提高性能；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("Loader")]),s._v(": 模块加载器，进行各种文件类型的加载与转换；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("Plugin")]),s._v(": 拓展插件，可以通过 Webpack 相应的事件钩子，介入到打包过程中的任意环节，从而对代码按需修改；")])])])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("工作流程")]),s._v(" (加载 - 编译 - 输出)")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("1、读取配置文件，按命令 "),a("strong",[s._v("初始化")]),s._v(" 配置参数，创建 Compiler 对象；")])]),s._v(" "),a("li",[a("p",[s._v("2、调用插件的 apply 方法 "),a("strong",[s._v("挂载插件")]),s._v(" 监听，然后从入口文件开始执行编译；")])]),s._v(" "),a("li",[a("p",[s._v("3、按文件类型，调用相应的 Loader 对模块进行 "),a("strong",[s._v("编译")]),s._v("，并在合适的时机点触发对应的事件，调用 Plugin 执行，最后再根据模块 "),a("strong",[s._v("依赖查找")]),s._v(" 到所依赖的模块，递归执行第三步；")])]),s._v(" "),a("li",[a("p",[s._v("4、将编译后的所有代码包装成一个个代码块 (Chuck)， 并按依赖和配置确定 "),a("strong",[s._v("输出内容")]),s._v("。这个步骤，仍然可以通过 Plugin 进行文件的修改;")])]),s._v(" "),a("li",[a("p",[s._v("5、最后，根据 Output 把文件内容一一写入到指定的文件夹中，完成整个过程；")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("模块包装")]),s._v(":")])])]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("modules")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 模拟 require 函数，从内存中加载模块；")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("__webpack_require__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("moduleId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 缓存模块")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("installedModules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("moduleId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" installedModules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("moduleId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" module "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" installedModules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("moduleId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" moduleId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            l"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            exports"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 执行代码；")]),s._v("\n        modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("moduleId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __webpack_require__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Flag: 标记是否加载完成；")]),s._v("\n        module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("l "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 开始执行加载入口文件；")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("__webpack_require__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__webpack_require__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("s "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./src/index.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./src/index.js"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __webpack_exports__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __webpack_require__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 使用 eval 执行编译后的代码；")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 继续递归引用模块内部依赖；")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 实际情况并不是使用模板字符串，这里是为了代码的可读性；")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("eval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\n            __webpack_require__.r(__webpack_exports__);\n            //\n            var _test__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("test", ./src/test.js");\n        ')]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./src/test.js"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __webpack_exports__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __webpack_require__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br")])]),a("ul",[a("li",[a("p",[a("strong",[s._v("总结")]),s._v(":")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("模块机制")]),s._v(": webpack 自己实现了一套模拟模块的机制，将其包裹于业务代码的外部，从而提供了一套模块机制；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("文件编译")]),s._v(": webpack 规定了一套编译规则，通过 Loader 和 Plugin，以管道的形式对文件字符串进行处理；")])])])])]),s._v(" "),a("h2",{attrs:{id:"_2-loader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-loader"}},[s._v("#")]),s._v(" "),a("strong",[s._v("2. Loader")])]),s._v(" "),a("p",[s._v("由于 Webpack 是基于 Node，因此 Webpack 其实是只能识别 js 模块，比如 css / html / 图片等类型的文件并无法加载，因此就需要一个对 "),a("strong",[s._v("不同格式文件转换器")]),s._v("。其实 Loader 做的事，也并不难理解: "),a("strong",[s._v("对 Webpack 传入的字符串进行按需修改")]),s._v("。例如一个最简单的 Loader:")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// html-loader/index.js")]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("exports")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("htmlSource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 返回处理后的代码字符串")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 删除 html 文件中的所有注释")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" htmlSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("\x3c!--[\\w\\W]*?--\x3e")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[s._v("g")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("当然，实际的 Loader 不会这么简单，通常是需要将代码进行分析，构建 "),a("strong",[s._v("AST (抽象语法树)")]),s._v("， 遍历进行定向的修改后，再重新生成新的代码字符串。如常用的 Babel-loader 会执行以下步骤:")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("babel-parser")]),s._v(" 将 ES6/ES7 代码解析成 AST")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("babel-traverse")]),s._v(" 对 AST 进行遍历转译，得到新的 AST")])]),s._v(" "),a("li",[a("p",[s._v("新 AST 通过 "),a("code",[s._v("babel-generator")]),s._v(" 转换成 ES5")])])]),s._v(" "),a("p",[a("strong",[s._v("Loader 特性")]),s._v(":")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("链式传递")]),s._v("，按照配置时相反的顺序链式执行；")])]),s._v(" "),a("li",[a("p",[s._v("基于 Node 环境，拥有 "),a("code",[s._v("较高权限")]),s._v("，比如文件的增删查改；")])]),s._v(" "),a("li",[a("p",[s._v("可同步也可异步；")])])]),s._v(" "),a("p",[a("strong",[s._v("常用 Loader")]),s._v(":")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("file-loader")]),s._v(": 加载文件资源，如 "),a("strong",[s._v("字体")]),s._v(" / "),a("strong",[s._v("图片")]),s._v(" 等，具有"),a("code",[s._v("移动")]),s._v("/"),a("code",[s._v("复制")]),s._v("/"),a("code",[s._v("命名")]),s._v("等功能；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("url-loader")]),s._v(": 通常用于"),a("strong",[s._v("加载图片")]),s._v("，可以将小图片直接转换为 "),a("code",[s._v("DataURL")]),s._v("，减少请求；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("babel-loader")]),s._v(": 加载 "),a("strong",[s._v("js")]),s._v(" / "),a("strong",[s._v("jsx")]),s._v(" 文件， 将 "),a("code",[s._v("ES6")]),s._v(" / "),a("code",[s._v("ES7")]),s._v(" 代码转换成 "),a("code",[s._v("ES5")]),s._v("，"),a("code",[s._v("抹平兼容性问题")]),s._v("；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("ts-loader")]),s._v(": 加载 "),a("strong",[s._v("ts")]),s._v(" / "),a("strong",[s._v("tsx")]),s._v(" 文件，编译 "),a("code",[s._v("TypeScript")]),s._v("；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("style-loader")]),s._v(": 将 "),a("strong",[s._v("css")]),s._v(" 代码以"),a("code",[s._v("<style>")]),s._v("标签的形式插入到 "),a("code",[s._v("html")]),s._v(" 中；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("css-loader")]),s._v(": 分析"),a("code",[s._v("@impor")]),s._v("t和"),a("code",[s._v("url()")]),s._v("，引用 "),a("strong",[s._v("css")]),s._v(" 文件与对应的资源；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("postcss-loader")]),s._v(": 用于 "),a("strong",[s._v("css 的兼容性处理")]),s._v("，具有众多功能，例如 添加"),a("code",[s._v("前缀")]),s._v("，"),a("code",[s._v("单位转换")]),s._v(" 等；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("less-loader")]),s._v(" / "),a("code",[s._v("sass-loader")]),s._v(": "),a("strong",[s._v("css")]),a("code",[s._v("预处理器")]),s._v("，在 css 中新增了许多语法，提高了开发效率；")])])]),s._v(" "),a("p",[a("strong",[s._v("编写原则:")])]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("单一原则")]),s._v(": 每个 Loader 只做一件事；")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("链式调用")]),s._v(": Webpack 会按顺序链式调用每个 Loader；")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("统一原则")]),s._v(": 遵循 Webpack 制定的设计规则和结构，输入与输出均为字符串，各个 Loader 完全独立，即插即用；")])])]),s._v(" "),a("h2",{attrs:{id:"_3-plugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-plugin"}},[s._v("#")]),s._v(" "),a("strong",[s._v("3. Plugin")])]),s._v(" "),a("p",[s._v("插件系统是 Webpack 成功的一个关键性因素。在编译的整个生命周期中，Webpack 会触发许多事件钩子，Plugin 可以监听这些事件，根据需求在相应的时间点对打包内容进行定向的修改。")]),s._v(" "),a("ul",[a("li",[s._v("一个最简单的 plugin 是这样的:")])]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注册插件时，会调用 apply 方法")]),s._v("\n  \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// apply 方法接收 compiler 对象")]),s._v("\n  \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 通过 compiler 上提供的 Api，可以对事件进行监听，执行相应的操作")]),s._v("\n  \t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("compiler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  \t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// compilation 是监听每次编译循环")]),s._v("\n  \t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 每次文件变化，都会生成新的 compilation 对象并触发该事件")]),s._v("\n    \tcompiler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'compilation'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("compilation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  \t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("注册插件")]),s._v(":")])]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// webpack.config.js")]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("export "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\tplugins"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("事件流机制")]),s._v(":")])]),s._v(" "),a("p",[s._v("Webpack 就像工厂中的一条产品流水线。原材料经过 "),a("strong",[s._v("Loader")]),s._v(" 与 "),a("strong",[s._v("Plugin")]),s._v(" 的一道道处理，最后输出结果。")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("通过链式调用，按顺序串起一个个 "),a("code",[s._v("Loader")]),s._v("；")])]),s._v(" "),a("li",[a("p",[s._v("通过事件流机制，让 "),a("code",[s._v("Plugin")]),s._v(" 可以插入到整个生产过程中的每个步骤中；")])])]),s._v(" "),a("p",[s._v("Webpack 事件流编程范式的核心是基础类 "),a("strong",[s._v("Tapable")]),s._v("，是一种 "),a("strong",[s._v("观察者模式")]),s._v(" 的实现事件的订阅与广播：")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" SyncHook "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tapable"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" hook "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SyncHook")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'arg'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 订阅")]),s._v("\nhook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tap")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'event'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("arg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 'event-hook'")]),s._v("\n\tconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("arg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 广播")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hook")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'event-hook'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("Webpack 中两个最重要的类 "),a("code",[s._v("Compiler")]),s._v(" 与 "),a("code",[s._v("Compilation")]),s._v(" 便是继承于 Tapable，也拥有这样的事件流机制。")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("Compiler")]),s._v(": 可以简单的理解为 "),a("strong",[s._v("Webpack 实例")]),s._v("，它包含了当前 Webpack 中的所有配置信息，如 options， loaders, plugins 等信息，全局唯一，只在启动时完成初始化创建，随着生命周期逐一传递；")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("Compilation")]),s._v(": 可以称为 "),a("strong",[s._v("编译实例")]),s._v("。当监听到文件发生改变时，Webpack 会创建一个新的 Compilation 对象，开始一次新的编译。它包含了当前的输入资源，输出资源，变化的文件等，同时通过它提供的 api，可以监听每次编译过程中触发的事件钩子；")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("区别")]),s._v(":")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("Compiler")]),s._v(" 全局唯一，且从启动生存到结束；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("Compilation")]),s._v(" 对应每次编译，每轮编译循环均会重新创建；")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("常用 Plugin")]),s._v(":")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("UglifyJsPlugin")]),s._v(": 压缩、混淆代码；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("CommonsChunkPlugin")]),s._v(": 代码分割；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("ProvidePlugin")]),s._v(": 自动加载模块；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("html-webpack-plugin")]),s._v(": 加载 html 文件，并引入 css / js 文件；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("extract-text-webpack-plugin")]),s._v(" / "),a("code",[s._v("mini-css-extract-plugin")]),s._v(": 抽离样式，生成 css 文件；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("DefinePlugin")]),s._v(": 定义全局变量；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("optimize-css-assets-webpack-plugin")]),s._v(": CSS 代码去重；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("webpack-bundle-analyzer")]),s._v(": 代码分析；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("compression-webpack-plugin")]),s._v(": 使用 gzip 压缩 js 和 css；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("happypack")]),s._v(": 使用多进程，加速代码构建；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("EnvironmentPlugin")]),s._v(": 定义环境变量；")])])])])]),s._v(" "),a("h2",{attrs:{id:"_4-编译优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-编译优化"}},[s._v("#")]),s._v(" "),a("strong",[s._v("4. 编译优化")])]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("代码优化")]),s._v(":")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("无用代码消除")]),s._v("，是许多编程语言都具有的优化手段，这个过程称为 DCE (dead code elimination)，即 "),a("strong",[s._v("删除不可能执行的代码")]),s._v("；")]),s._v(" "),a("ul",[a("li",[s._v("例如的 "),a("code",[s._v("UglifyJs")]),s._v("，它就会帮在生产环境中删除不可能被执行的代码，例如:")])]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("fn")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 下面代码便属于 不可能执行的代码；")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 通过 UglifyJs (Webpack4+ 已内置) 便会进行 DCE；")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("摇树优化")]),s._v(" ("),a("code",[s._v("Tree-shaking")]),s._v(')，这是一种形象比喻。把打包后的代码比喻成一棵树，这里其实表示的就是，通过工具 "摇" 打包后的 js 代码，将没有使用到的无用代码 "摇" 下来 (删除)。即 消除那些被 '),a("strong",[s._v("引用了但未被使用")]),s._v(" 的模块代码。")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("原理")]),s._v(": 由于是在编译时优化，因此最基本的前提就是语法的静态分析，"),a("strong",[s._v("ES6的模块机制")]),s._v(" 提供了这种可能性。不需要运行时，便可进行代码字面上的静态分析，确定相应的依赖关系。")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("问题")]),s._v(": 具有 "),a("strong",[s._v("副作用")]),s._v(" 的函数无法被 "),a("code",[s._v("tree-shaking")]),s._v("。")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("在引用一些第三方库，需要去观察其引入的代码量是不是符合预期；")])]),s._v(" "),a("li",[a("p",[s._v("尽量写"),a("code",[s._v("纯函数")]),s._v("，减少"),a("code",[s._v("函数的副作用")]),s._v("；")])]),s._v(" "),a("li",[a("p",[s._v("可使用 "),a("code",[s._v("webpack-deep-scope-plugin")]),s._v("，可以进行作用域分析，减少此类情况的发生，但仍需要注意；")])])])])])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("code-spliting: 代码分割")])]),s._v(" "),a("p",[s._v("将代码分割成多份进行 "),a("code",[s._v("懒加载")]),s._v(" 或 "),a("code",[s._v("异步加载")]),s._v("，避免打包成一份后导致体积过大，影响页面的首屏加载；")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("Webpack")]),s._v(" 中使用 "),a("code",[s._v("SplitChunksPlugin")]),s._v(" 进行拆分；")])]),s._v(" "),a("li",[a("p",[s._v("按 "),a("strong",[s._v("页面")]),s._v(" 拆分: 不同页面打包成不同的文件；")])]),s._v(" "),a("li",[a("p",[s._v("按 "),a("strong",[s._v("功能")]),s._v(" 拆分:")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("将类似于播放器，计算库等大模块进行拆分后再懒加载引入；")])]),s._v(" "),a("li",[a("p",[s._v("提取复用的业务代码，减少冗余代码；")])])])]),s._v(" "),a("li",[a("p",[s._v("按 "),a("strong",[s._v("文件修改频率")]),s._v(" 拆分: 将第三方库等不常修改的代码单独打包，而且不改变其文件 hash 值，能最大化运用浏览器的缓存；")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("scope hoisting: 作用域提升")])]),s._v(" "),a("p",[s._v("将分散的模块划分到同一个作用域中，避免了代码的重复引入，有效减少打包后的代码体积和运行时的内存损耗；")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("编译性能优化")]),s._v(":")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("升级至 "),a("code",[s._v("最新")]),s._v(" 版本的 webpack，能有效提升编译性能；")])]),s._v(" "),a("li",[a("p",[s._v("使用 "),a("code",[s._v("dev-server")]),s._v(" / "),a("code",[s._v("模块热替换 (HMR)")]),s._v(" 提升开发体验；")]),s._v(" "),a("ul",[a("li",[s._v("监听文件变动 "),a("code",[s._v("忽略")]),s._v(" "),a("strong",[s._v("node_modules")]),s._v(" 目录能有效提高监听时的编译效率；")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("缩小编译范围")]),s._v(":")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("modules")]),s._v(": 指定模块路径，减少递归搜索；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("mainFields")]),s._v(": 指定入口文件描述字段，减少搜索；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("noParse")]),s._v(": 避免对非模块化文件的加载；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("includes")]),s._v("/"),a("code",[s._v("exclude")]),s._v(": 指定搜索范围/排除不必要的搜索范围；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("alias")]),s._v(": 缓存目录，避免重复寻址；")])])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("babel-loader")]),s._v(":")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("忽略node_moudles")]),s._v("，避免编译第三方库中已经被编译过的代码；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("使用cacheDirectory")]),s._v("，可以缓存编译结果，避免多次重复编译；")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("多进程并发")]),s._v(":")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("webpack-parallel-uglify-plugin")]),s._v(": 可多进程并发"),a("code",[s._v("压缩")]),s._v(" js 文件，提高压缩速度；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("HappyPack")]),s._v(": 多进程并发文件的 "),a("code",[s._v("Loader")]),s._v(" 解析；")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("第三方库模块缓存")]),s._v(":")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("DLLPlugin")]),s._v(" 和 "),a("code",[s._v("DLLReferencePlugin")]),s._v(" 可以提前进行打包并缓存，避免每次都重新编译；")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用分析")]),s._v(":")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("Webpack Analyse")]),s._v(" / "),a("code",[s._v("webpack-bundle-analyzer")]),s._v(" 对打包后的文件进行分析，寻找可优化的地方；")])]),s._v(" "),a("li",[a("p",[s._v("配置"),a("code",[s._v("profile：true")]),s._v("，对各个编译阶段耗时进行监控，寻找耗时最多的地方；")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("source-map")]),s._v(":")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("开发: "),a("code",[s._v("cheap-module-eval-source-map")]),s._v("；")])]),s._v(" "),a("li",[a("p",[s._v("生产: "),a("code",[s._v("hidden-source-map")]),s._v("；")])])])])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);
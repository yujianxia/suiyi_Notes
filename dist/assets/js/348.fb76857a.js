(window.webpackJsonp=window.webpackJsonp||[]).push([[348],{709:function(t,e,a){"use strict";a.r(e);var s=a(25),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"å¼•å…¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¼•å…¥"}},[t._v("#")]),t._v(" å¼•å…¥")]),t._v(" "),a("p",[t._v("åœ¨ç»„å†…åšäº†ä¸€æ¬¡ React çŠ¶æ€ç®¡ç†çš„åˆ†äº«ï¼Œæ€»ç»“äº†ä¸€äº› redux çš„é—®é¢˜ï¼Œå®‰åˆ©äº†ä¸€ä¸‹ mobx æ›´æ–¹ä¾¿çš„åœ°æ–¹ã€‚æ•´ç†æˆæ–‡å­—ï¼Œä¾¿æ˜¯æ­¤æ–‡ã€‚æ³¨ï¼šæœ¬æ–‡æœªæ•´ç†å®Œï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯åˆ—çš„å¤§çº²ï¼Œé¢„è®¡å‘¨äºŒå‰æ•´ç†å®Œã€‚ps: åº”è¯¥æ•´ç†ä¸å®Œ")]),t._v(" "),a("h1",{attrs:{id:"ç›®å½•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç›®å½•"}},[t._v("#")]),t._v(" ç›®å½•")]),t._v(" "),a("ul",[a("li",[t._v("React çŠ¶æ€ã€é€šä¿¡")]),t._v(" "),a("li",[t._v("Flux â€”Redux â€”Mobx")]),t._v(" "),a("li",[t._v("reduxï¼Œmobx å¯¹æ¯”")])]),t._v(" "),a("h1",{attrs:{id:"react-ä¸ºä»€ä¹ˆéœ€è¦çŠ¶æ€ç®¡ç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#react-ä¸ºä»€ä¹ˆéœ€è¦çŠ¶æ€ç®¡ç†"}},[t._v("#")]),t._v(" React ä¸ºä»€ä¹ˆéœ€è¦çŠ¶æ€ç®¡ç†")]),t._v(" "),a("p",[t._v("ä¸å¦¨å…ˆå›å¿†ä¸€ä¸‹ react çš„ç‰¹ç‚¹ã€‚")]),t._v(" "),a("h2",{attrs:{id:"react-ç‰¹ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#react-ç‰¹ç‚¹"}},[t._v("#")]),t._v(" React ç‰¹ç‚¹")]),t._v(" "),a("ul",[a("li",[t._v("ä¸“æ³¨ view å±‚")])]),t._v(" "),a("p",[t._v("React å®˜ç½‘æ˜¯è¿™ä¹ˆç®€ä»‹çš„ã€‚JavaScript library for building user interfaces.ä¸“æ³¨ view å±‚ çš„ç‰¹ç‚¹å†³å®šäº†å®ƒä¸æ˜¯ä¸€ä¸ªå…¨èƒ½æ¡†æ¶ï¼Œç›¸æ¯” angular è¿™ç§å…¨èƒ½æ¡†æ¶ï¼ŒReact åŠŸèƒ½è¾ƒç®€å•ï¼Œå•ä¸€ã€‚æ¯”å¦‚è¯´æ²¡æœ‰å‰ç«¯è·¯ç”±ï¼Œæ²¡æœ‰çŠ¶æ€ç®¡ç†ï¼Œæ²¡æœ‰ä¸€ç«™å¼å¼€å‘æ–‡æ¡£ç­‰ã€‚")]),t._v(" "),a("ul",[a("li",[t._v("f(state) = view")])]),t._v(" "),a("p",[t._v("react ç»„ä»¶æ˜¯æ ¹æ® state ï¼ˆæˆ–è€… propsï¼‰å»æ¸²æŸ“é¡µé¢çš„ï¼Œç±»ä¼¼äºä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ stateï¼Œè¾“å‡º viewã€‚ä¸è¿‡è¿™ä¸æ˜¯å®Œæ•´æ„ä¹‰ä¸Šçš„ MDVï¼ˆModel Driven Viewï¼‰ï¼Œæ²¡æœ‰å®Œå¤‡çš„ model å±‚ã€‚é¡ºä¾¿æä¸€å¥ï¼Œæ„Ÿè§‰ç°åœ¨çš„ç»„ä»¶åŒ–å’Œ MDV åœ¨å‰ç«¯å¼€å‘ä¸­æ­£ç«çƒ­ï¼Œå¤§åŠ¿æ‰€è¶‹...")]),t._v(" "),a("ul",[a("li",[t._v("state è‡ªä¸Šè€Œä¸‹æµå‘ã€Props åªè¯»")])]),t._v(" "),a("p",[t._v("ä»æœ€å¼€å§‹å†™ React å¼€å§‹ï¼Œå°±äº†è§£è¿™æ¡ç‰¹ç‚¹äº†ã€‚state æµå‘æ˜¯è‡ªç»„ä»¶ä»å¤–åˆ°å†…ï¼Œä»ä¸Šåˆ°ä¸‹çš„ï¼Œè€Œä¸”ä¼ é€’ä¸‹æ¥çš„ props æ˜¯åªè¯»çš„ï¼Œå¦‚æœä½ æƒ³æ›´æ”¹ propsï¼Œåªèƒ½ä¸Šå±‚ç»„ä»¶ä¼ ä¸‹ä¸€ä¸ªåŒ…è£…å¥½çš„ setState æ–¹æ³•ã€‚ä¸åƒ angular æœ‰ ng-model, vue æœ‰ v-modelï¼Œ æä¾›äº†åŒå‘ç»‘å®šçš„æŒ‡ä»¤ã€‚React ä¸­çš„çº¦å®šå°±æ˜¯è¿™æ ·ï¼Œä½ å¯èƒ½è§‰å¾—è¿™å¾ˆç¹çï¼Œä¸è¿‡ state çš„æµå‘å´æ›´æ¸…æ™°äº†ï¼Œå•å‘æ•°æ®æµåœ¨å¤§å‹ spa æ€»æ˜¯è¦è®¨å¥½ä¸€äº›çš„ã€‚")]),t._v(" "),a("p",[t._v("è¿™äº›ç‰¹ç‚¹å†³å®šäº†ï¼ŒReact æœ¬èº«æ˜¯æ²¡æœ‰æä¾›å¼ºå¤§çš„çŠ¶æ€ç®¡ç†åŠŸèƒ½çš„ï¼Œé‚£ React ç»„ä»¶æ˜¯å¦‚ä½•é€šä¿¡å‘¢ï¼ŸåŸç”Ÿå¤§æ¦‚æ˜¯ä¸‰ç§æ–¹å¼ã€‚")]),t._v(" "),a("h2",{attrs:{id:"react-ç»„ä»¶é€šä¿¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#react-ç»„ä»¶é€šä¿¡"}},[t._v("#")]),t._v(" React ç»„ä»¶é€šä¿¡")]),t._v(" "),a("p",[t._v("ä¹‹å‰æœ‰æ€»ç»“è¿‡ "),a("a",{attrs:{href:"https://github.com/sunyongjian/blog/issues/27",target:"_blank",rel:"noopener noreferrer"}},[t._v("React çš„é€šä¿¡é—®é¢˜"),a("OutboundLink")],1),t._v("ï¼Œå†æ¬¡ç®€å•æä¸€ä¸‹ï¼Œå¹¶è¯´æ˜å®ƒä»¬å­˜åœ¨çš„é—®é¢˜ã€‚å…¶å®å¤§æ¦‚å°±æ˜¯ä¸¤ç§æ–¹å¼ï¼Œå…¶ä¸€æ˜¯çŠ¶æ€æå‡ï¼Œå³æŠŠéœ€è¦é€šä¿¡çš„ state æå‡åˆ°ä¸¤è€…å…±åŒçš„çˆ¶ç»„ä»¶ï¼Œå®ç°å…±äº«å’Œ Reactionã€‚ä¸è¿‡çŠ¶æ€æå‡åˆåˆ†ä¸º Continer ç»„ä»¶å®šä¹‰å’Œä½¿ç”¨ Context å±æ€§ä¼ é€’ï¼Œè¿™ä¸¤è€…è™½ç„¶éƒ½ç®—æ˜¯çŠ¶æ€æå‡ï¼Œä½†æ˜¯å®é™…ä¸å¤ªä¸€æ ·ï¼Œæ‰€ä»¥ä¼šåˆ†ä¸ºä¸‰ç§æ–¹å¼ã€‚\n"),a("img",{attrs:{alt:"tx1",width:"394",src:"https://user-images.githubusercontent.com/18378034/34917562-2c68a1fe-f983-11e7-88d0-b92ddceb3676.png"}})]),t._v(" "),a("p",[t._v("å¦‚å›¾ã€‚A,B ç»„ä»¶ä¸‹çš„ A1,B1 è¦å®ç° state é€šä¿¡ã€‚")]),t._v(" "),a("ul",[a("li",[t._v("Continer")])]),t._v(" "),a("img",{attrs:{alt:"tx3",width:"376",src:"https://user-images.githubusercontent.com/18378034/34917565-3524b238-f983-11e7-905d-e6e6fd1af879.png"}}),t._v(" "),a("p",[t._v("åœ¨ A,B ä¹‹ä¸Šå¢åŠ ä¸€ä¸ª Container ç»„ä»¶ï¼Œå¹¶æŠŠ A1ï¼ŒB1 éœ€è¦å…±äº«çš„çŠ¶æ€æå‡ï¼Œå®šä¹‰åˆ° Containerï¼Œé€šè¿‡ props ä¼ é€’ state ä»¥åŠ changeState çš„æ–¹æ³•ã€‚\næ­¤æ–¹å¼å­˜åœ¨çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œä»¥åå¦‚æœæœ‰ä¸€ä¸ª C ç»„ä»¶çš„ stateï¼Œä¸ A è¦åšé€šä¿¡ï¼Œå°±ä¼šå†æ·»åŠ ä¸€ä¸ª Container ç»„ä»¶ï¼Œå¦‚æœæ˜¯ A çš„ state è¦è·Ÿ C å…±äº«ï¼Œæ›´æ˜¯æ¯ç­æ€§æ‰“å‡»ï¼Œä¹‹å‰æå‡åˆ° Container çš„ stateï¼Œè¿˜è¦å†æå‡ä¸€å±‚ã€‚è¿™ç§æ— ä¼‘æ­¢çš„çŠ¶æ€æå‡é—®é¢˜ï¼ŒåæœŸçš„é€šä¿¡æˆæœ¬éå¸¸é«˜ï¼Œå‡ ä¹æ˜¯é‡å†™ã€‚")]),t._v(" "),a("ul",[a("li",[t._v("Context\n"),a("a",{attrs:{"data-fancybox":"",title:"image",href:"https://user-images.githubusercontent.com/18378034/34917764-630fb04c-f985-11e7-9b4c-31af22e36618.png"}},[a("img",{attrs:{src:"https://user-images.githubusercontent.com/18378034/34917764-630fb04c-f985-11e7-9b4c-31af22e36618.png",alt:"image"}})])])]),t._v(" "),a("p",[t._v("ä¹ä¸€çœ‹ï¼ŒContext åƒæ˜¯ä¸€ä¸ªå¥½çš„æ–¹æ¡ˆï¼Œå®ƒè§£å†³äº†æ— é™çŠ¶æ€æå‡çš„é—®é¢˜ï¼Œéƒ½ç»Ÿä¸€æ”¾åˆ°å®šä¹‰ Context çš„ç»„ä»¶å°±å¥½äº†ã€‚ä¸è¿‡ React å®˜ç½‘å€’æ˜¯ä¸å»ºè®®ç”¨å®ƒ "),a("a",{attrs:{href:"https://reactjs.org/docs/context.html#why-not-to-use-context",target:"_blank",rel:"noopener noreferrer"}},[t._v("Why Not To Use Context"),a("OutboundLink")],1),t._v("ï¼Œç†ç”±æ˜¯å®ƒä¸€ä¸ªå®éªŒæ€§çš„ç‰¹æ€§ï¼Œæœªæ¥å¯èƒ½ç§»é™¤ã€‚ä¸è¿‡ä¸ªäººè§‰å¾—å·²ç»ä¸å¤ªå¯èƒ½ç§»é™¤äº†ï¼Œå› ä¸ºåŸºæœ¬ React çš„ Provider ç»„ä»¶éƒ½æ˜¯åŸºäºæ­¤åšçš„ã€‚")]),t._v(" "),a("p",[t._v("ä¸‹é¢æ˜¯ Context å®šä¹‰çš„ä¸€æ®µä»£ç ï¼š\n"),a("a",{attrs:{"data-fancybox":"",title:"image",href:"https://user-images.githubusercontent.com/18378034/34917765-678b1b70-f985-11e7-8e44-92c5f1ae1162.png"}},[a("img",{attrs:{src:"https://user-images.githubusercontent.com/18378034/34917765-678b1b70-f985-11e7-8e44-92c5f1ae1162.png",alt:"image"}})])]),t._v(" "),a("p",[t._v("çœŸæ­£ä¸è¦ä½¿ç”¨ Context çš„åŸå› æ˜¯ï¼Œå®ƒåœ¨çŠ¶æ€æ›´æ–°é€šçŸ¥ç»„ä»¶æ–¹é¢å­˜åœ¨ç¼ºé™·ã€‚Context çš„æœºåˆ¶æ˜¯è¿™æ ·çš„ï¼Œå‡å¦‚ context ä¸­å®šä¹‰å­˜åœ¨å˜åŒ–çš„å€¼ï¼Œæ¯”å¦‚ä¸Šå›¾çš„ valueï¼ŒContext ç»„ä»¶ä¼šé‡æ–°æ¸²æŸ“(æ‰§è¡Œ SCUï¼ŒwillReceivedProps)ï¼Œé‡æ–°ç”Ÿæˆ context å¯¹è±¡ã€‚æ­¤ä¸¾ä¼šä½¿å¾— Context ä¸‹é¢çš„æ‰€æœ‰ç»„ä»¶éƒ½é‡æ–° renderï¼Œæ‰å¯ä»¥æ¥æ”¶åˆ°æœ€æ–°çš„ context å¯¹è±¡ã€‚")]),t._v(" "),a("p",[t._v("å‡å¦‚æŸä¸€å±‚ï¼Œæ¯”å¦‚ç»„ä»¶ Aï¼Œæ²¡æœ‰ re-renderï¼Œè®¾ç½®äº† "),a("code",[t._v("shouldComponentUpdate = false")]),t._v("ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ª pureComponentï¼Œéƒ½ä¼šé˜»ç¢ context å¯¹è±¡çš„ä¼ é€’ï¼Œç›¸å½“äºåœ¨æµå‘ä¸­åŠ äº†ä¸€å µå¢™ã€‚")]),t._v(" "),a("p",[t._v("è€Œè§£å†³è¿™ä¸ªé—®é¢˜çš„åŠæ³•ï¼Œå°±æ˜¯ä½¿ç”¨å‘å¸ƒè®¢é˜…å»æ”¹é€ ã€‚context å¯¹è±¡ä¸å†å‘ç”Ÿæ”¹å˜ï¼Œè€Œä¸”å­ç»„ä»¶åªç¬¬ä¸€æ¬¡æ„å»ºçš„æ—¶å€™æ¥æ”¶ context å¯¹è±¡ï¼Œè¿™æ„å‘³ç€ context å¯¹è±¡è¦å†…éƒ¨å®ç°è®¢é˜…å’Œå‘å¸ƒçš„åŠŸèƒ½ï¼Œå³ç»„ä»¶ä½¿ç”¨çš„æ—¶å€™è®¢é˜…ï¼Œå¯¹è±¡å±æ€§å˜åŒ–çš„æ—¶å€™é€šçŸ¥ç»„ä»¶ renderã€‚å…³äºæ­¤è¯¦ç»†å†…å®¹å¯ä»¥åˆ°"),a("a",{attrs:{href:"https://medium.com/@mweststrate/how-to-safely-use-react-context-b7e343eff076",target:"_blank",rel:"noopener noreferrer"}},[t._v("å¦‚ä½•å®‰å…¨çš„ä½¿ç”¨ Context"),a("OutboundLink")],1),t._v("æŸ¥çœ‹ï¼ˆéœ€è¦å…¨å±€ç¿»å¢™ï¼‰")]),t._v(" "),a("ul",[a("li",[t._v("å‘å¸ƒè®¢é˜…")])]),t._v(" "),a("img",{attrs:{alt:"listx",width:"381",src:"https://user-images.githubusercontent.com/18378034/34917569-417a2da6-f983-11e7-87a3-62d3d0f8747f.png"}}),t._v(" "),a("p",[t._v("è¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå°±æ˜¯ä¸€ä¸ªç»„ä»¶è®¢é˜…ï¼Œä¸€ä¸ªç»„ä»¶å‘å¸ƒï¼Œäº†è§£è§‚å¯Ÿè€…æ¨¡å¼çš„éƒ½æ¸…é™¤ï¼Œ"),a("a",{attrs:{href:"https://github.com/sunyongjian/blog/issues/27",target:"_blank",rel:"noopener noreferrer"}},[t._v("è¿™é‡Œ"),a("OutboundLink")],1),t._v(" ä¹Ÿæœ‰è¯¦ç»†çš„ä»£ç ã€‚æƒ³æŒ‡å‡ºçš„æ˜¯è¿™ç§æ–¹å¼è™½ç„¶è§£å†³äº†çŠ¶æ€æå‡å¸¦æ¥çš„é—®é¢˜ï¼Œä½†æ˜¯ state ä¿å­˜åœ¨å„ä¸ªç»„ä»¶ä¸­ï¼Œå¦‚æœè¦åšé€šä¿¡ï¼Œéœ€è¦å†™å¾ˆå¤šè®¢é˜…/å‘å¸ƒçš„ä»£ç ï¼Œè€Œä¸”è¿™éƒ¨åˆ†ä»£ç ä¹Ÿä¸å¥½å°è£…ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œæ•°æ®æµå˜å¾—å¾ˆä¹±ï¼Œäº’ç›¸ä¹‹é—´éƒ½æœ‰ä¾èµ–ï¼Œè®©ä»£ç ç»´æŠ¤èµ·æ¥æ¯”è¾ƒå›°éš¾ã€‚")]),t._v(" "),a("p",[t._v("å…¶å®åœ¨è¿™é‡Œå°±ä¼šæƒ³åˆ°ï¼Œå‡å¦‚è¯´è®© Event ä¸­å¿ƒç»Ÿä¸€ç®¡ç†çŠ¶æ€ï¼Œç»Ÿä¸€åˆ†å‘å‘¢ï¼Œç„¶åæ¯ä¸ªç»„ä»¶åªéœ€è¦æ¥æ”¶ï¼Œè®¢é˜…çš„å·¥ä½œäº¤ç»™ hoc å»å¤„ç†ï¼Œåªéœ€è¦å‘Šè¯‰ hoc è¦ä»€ä¹ˆ stateï¼Œå®ƒéä» Event ä¸­å¿ƒå»å–ã€‚å½“ state å‘ç”Ÿæ”¹å˜ï¼ŒEvent ä¸­å¿ƒ pub äº‹ä»¶ï¼Œhoc å»å¤„ç† re-render çš„å·¥ä½œï¼Œæ„Ÿè§‰è¿™å°±æ˜¯ç›®å‰çŠ¶æ€ç®¡ç† library éƒ½åœ¨åšçš„ï¼Œå¤§åŒå°å¼‚ã€‚")]),t._v(" "),a("h3",{attrs:{id:"é—®é¢˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é—®é¢˜"}},[t._v("#")]),t._v(" é—®é¢˜")]),t._v(" "),a("p",[t._v("æ‰€ä»¥éšç€ spa çš„å¢å¤§ï¼Œè¿™äº›æ–¹å¼éƒ½ä¼šæœ‰ä¸€äº›é—®é¢˜ï¼ŒçŠ¶æ€æ— ä¼‘æ­¢æå‡ï¼Œcontext ä¸å¥½ç”¨ï¼Œå‘å¸ƒè®¢é˜…æ•°æ®æµå‘æ··ä¹±ï¼Œè·Ÿç»„ä»¶çš„è€¦åˆæ€§è¾ƒé«˜ï¼Œæ•°æ®æµä¸æ¸…æ™°ï¼Œ\nå¤§å‹ spa ç»„ä»¶é€šä¿¡æˆæœ¬å¤ªé«˜ã€‚\n"),a("img",{attrs:{alt:"statetx",width:"385",src:"https://user-images.githubusercontent.com/18378034/34917598-8922ea26-f983-11e7-9318-b2c277a6c7b6.png"}})]),t._v(" "),a("p",[t._v("æ‰€æœ‰å¸Œæœ›æœ‰ä¸€ä¸ªç‹¬ç«‹ç®¡ç†çš„åœ°æ–¹ï¼Œåƒè¿™æ ·ï¼š\n"),a("img",{attrs:{alt:"storetx",width:"351",src:"https://user-images.githubusercontent.com/18378034/34917603-9d321a96-f983-11e7-8fea-e4764fef1010.png"}})]),t._v(" "),a("p",[t._v("å®ƒå¯èƒ½ä¼šæœ‰ä¸€ä¸ª store çš„æ¦‚å¿µï¼Œstore å»å­˜å‚¨æ•°æ®å’ŒçŠ¶æ€ï¼Œè¿˜éœ€è¦å¯ä»¥è¢«è®¢é˜…ï¼Œå³ store ä¸­çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–è¦åšåˆ°åŠæ—¶çš„é€šçŸ¥ã€‚å†è¿›ä¸€æ­¥å°±æ˜¯å¯ä»¥è·Ÿç»„ä»¶çš„äº¤äº’ï¼Œé€šä¿¡éƒ½äº¤ç»™ store æ¥å¤„ç†ã€‚\nè¿˜å¯ä»¥åŒºåˆ†å˜åŒ–å’Œå‰¯ä½œç”¨ï¼Œåšä¸åŒçš„å¤„ç†ã€‚")]),t._v(" "),a("p",[t._v("ç›®å‰ç¤¾åŒºä¸­ç†ŸçŸ¥çš„çŠ¶æ€ç®¡ç†åº“å°±é‚£å‡ ä¸ªï¼Œæ¥ä¸‹æ¥æŒ‰ç…§è¿™å‡ ä¸ªåº“çš„å‘å¸ƒé¡ºåºä»‹ç»ä¸€ä¸‹ã€‚")]),t._v(" "),a("h1",{attrs:{id:"flux"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flux"}},[t._v("#")]),t._v(" Flux")]),t._v(" "),a("p",[t._v("Flux æ˜¯éšç€ React çš„è¯ç”Ÿï¼Œè€Œæå‡ºçš„ä¸€ç§çŠ¶æ€ç®¡ç†çš„è§£å†³æ–¹æ¡ˆã€‚ç”±äº MVC æ¨¡å¼åœ¨å¤§å‹å‰ç«¯åº”ç”¨é‡Œå˜å¾—æµå‘å¤æ‚ï¼Œä»¥åŠ Model å’Œ View çš„åŒå‘ç»‘å®šé—®é¢˜ã€‚ä¾¿æå‡ºäº†è¿™æ ·çš„ç»“æ„ï¼š\n"),a("a",{attrs:{"data-fancybox":"",title:"flux",href:"https://user-images.githubusercontent.com/18378034/34917580-58d83204-f983-11e7-804f-4b88caaf1e28.jpg"}},[a("img",{attrs:{src:"https://user-images.githubusercontent.com/18378034/34917580-58d83204-f983-11e7-804f-4b88caaf1e28.jpg",alt:"flux"}})])]),t._v(" "),a("p",[t._v("ä» flux å¼€å§‹ï¼Œå°±æ˜¯ä¸¥æ ¼çš„æ•°æ®æµå‘ï¼Œåªèƒ½é€šè¿‡ actions æ”¹å˜ storeï¼Œactions æ˜¯å€ŸåŠ© Dipatcher.dispatch\nè¿™æ ·çš„ API å‘å‡ºï¼Œç„¶åå†ä¿®æ”¹ storeï¼Œç”± store å»æ›´æ–° viewã€‚")]),t._v(" "),a("p",[t._v("å‡ ä¸ªä¸»è¦çš„æ¦‚å¿µï¼š")]),t._v(" "),a("ul",[a("li",[t._v("Dispatcherï¼Œå¤„ç†åŠ¨ä½œçš„åˆ†å‘ï¼Œä¿®æ”¹ Store ä¸Šçš„æ•°æ®ã€‚registerï¼Œdispatch")]),t._v(" "),a("li",[t._v("Storeï¼Œè´Ÿè´£å­˜å‚¨æ•°æ®å’Œå¤„ç†æ•°æ®ç›¸å…³çš„é€»è¾‘.addChangeListener")]),t._v(" "),a("li",[t._v("Actionï¼Œé©±åŠ¨ Dipatcher çš„ JS å¯¹è±¡")]),t._v(" "),a("li",[t._v("VIewï¼Œè§†å›¾éƒ¨åˆ†ï¼Œå±•ç¤ºæ•°æ®,react ç»„ä»¶çš„åˆ†å±‚ç»„åˆ")])]),t._v(" "),a("p",[t._v("flux åœ¨ store é©±åŠ¨ç»„ä»¶è¿™ä¸€å±‚ï¼Œæ²¡æœ‰åšå¾ˆå¥½çš„æ”¯æŒï¼Œå¦‚æœè¦åšéœ€è¦é¢‘ç¹çš„ç»‘å®šäº‹ä»¶ã€‚å¦å¤– action ä¹Ÿæ²¡æœ‰å¾ˆå¥½çš„å¼‚æ­¥æ–¹æ¡ˆã€‚è¿™äº›å·¥ä½œéƒ½éœ€è¦ç”¨æˆ·è‡ªå·±å»æ‘¸ç´¢å¤„ç†ã€‚æ‰€ä»¥åœ¨ redux å»å¤„ç†å¥½è¿™äº›é—®é¢˜ï¼Œå¹¶ä¸”æå‡ºäº†æ›´å¥½çš„æ€æƒ³çš„æ—¶å€™ï¼Œflux å¾ˆå¿«å°±è¢«æ›¿ä»£äº†ã€‚ä¸è¿‡ flux ä¸º redux åšäº†å¾ˆå¥½çš„å€Ÿé‰´ï¼Œæµç¨‹ï¼Œaction å¯¹è±¡ï¼Œå•å‘æ•°æ®æµã€‚")]),t._v(" "),a("h1",{attrs:{id:"redux"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redux"}},[t._v("#")]),t._v(" Redux")]),t._v(" "),a("p",[a("a",{attrs:{"data-fancybox":"",title:"redux",href:"https://user-images.githubusercontent.com/18378034/34917582-5c04bb28-f983-11e7-8fba-aa0f9b3b65dc.jpg"}},[a("img",{attrs:{src:"https://user-images.githubusercontent.com/18378034/34917582-5c04bb28-f983-11e7-8fba-aa0f9b3b65dc.jpg",alt:"redux"}})])]),t._v(" "),a("p",[t._v("å¦‚æœè¯´ flux æ˜¯ä¸€ç§æ€æƒ³çš„è¯ï¼Œredux å°±æ˜¯å¯¹ flux æœ€å¥½çš„å®ç°ã€‚redux æŠŠ flux çš„å¤šä¸ª store æ¦‚å¿µå¹²æ‰äº†ï¼Œåªæœ‰ä¸€ä¸ª storeï¼Œå¹¶ä¸”å†…éƒ¨ç”± reducer è®¡ç®—ç”Ÿæˆæ–°çš„ state treeã€‚æŠŠ dispatcher è·Ÿ action è§£è€¦ï¼Œaction å°±æ˜¯ä¸€ä¸ªç®€å•çš„ actionCreatorã€‚redux ä¹ŸåŸºäº koa çš„ä¸­é—´ä»¶æ€æƒ³ï¼Œä¸°å¯Œäº†è‡ªå·±çš„æ‹“å±•æ€§ã€‚")]),t._v(" "),a("p",[t._v("å‡ ä¸ªä¸»è¦çš„æ¦‚å¿µï¼š")]),t._v(" "),a("ul",[a("li",[t._v("ä¸€ä¸ª storeï¼Œç®¡ç† stateï¼Œå¹¶æœ‰ dispatch(action) ï¼Œsubscribe ç­‰æ–¹æ³•ã€‚")]),t._v(" "),a("li",[t._v("Reducers. Old =new stateã€‚çº¯å‡½æ•°ï¼Œç”¨äºè®¡ç®—æ–°çš„ stateã€‚")]),t._v(" "),a("li",[t._v("å¤šäº† Providerï¼Œstore çš„è®¢é˜…è€…ï¼Œé€šè¿‡å®ƒæ¥ä¸ react ç­‰æ¡†æ¶äº¤äº’ï¼Œæ¯”å¦‚ react-redux ä¸­çš„ Providerã€‚")]),t._v(" "),a("li",[t._v("Actionsã€‚ç”± provider åˆ›å»ºå¹¶ç”±ç”¨æˆ·äº‹ä»¶è§¦å‘ã€‚")])]),t._v(" "),a("p",[t._v("å¦‚æœä½ æ˜¯ flux çš„ä½¿ç”¨è€…ï¼Œredux å‡ºç°çš„æ—¶å€™ï¼Œä½ åŸºæœ¬å¾ˆå®¹æ˜“æ¥å—è¿™ä¸ªæ€æƒ³ï¼Œé™¤äº†ä¸€äº›å‡½æ•°å¼çš„æ€ç»´ã€‚å†…å®¹æ–¹é¢åœ¨è¿™ä¸è¿‡å¤šé˜è¿°äº†ï¼Œè¿™ä¸æ˜¯æœ¬æ¬¡çš„ä¸»é¢˜ï¼Œé¢å‘çš„ä¹Ÿæ˜¯ä½¿ç”¨è¿‡çš„åŒå­¦ã€‚")]),t._v(" "),a("h2",{attrs:{id:"redux-ç”Ÿå‘½å‘¨æœŸ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redux-ç”Ÿå‘½å‘¨æœŸ"}},[t._v("#")]),t._v(" Redux ç”Ÿå‘½å‘¨æœŸ")]),t._v(" "),a("ul",[a("li",[t._v("Store.dispatch(action)")]),t._v(" "),a("li",[t._v("Reducer  æ‰§è¡Œ")]),t._v(" "),a("li",[t._v("ç”Ÿæˆ state tree")]),t._v(" "),a("li",[t._v("Store.subscribe(listener)")])]),t._v(" "),a("p",[t._v("ä¸è¿‡åœ¨æºç é‡Œï¼Œéƒ½æ˜¯åœ¨ createStore åˆå§‹åŒ–çš„æ—¶å€™ï¼Œdispatch æ–¹æ³•é‡Œå®ç°çš„ã€‚Redux çš„ storeï¼Œè·Ÿä¸Šé¢åœ¨â€œå‘å¸ƒè®¢é˜…â€è®¾æƒ³çš„ä¸€ç§æ€æƒ³å°±å¾ˆå¥‘åˆäº†ï¼Œstore ä¸ä»…ä½œä¸ºä¸€ä¸ª state çš„å­˜å‚¨ä¸­å¿ƒï¼Œè¿˜æ˜¯äº‹ä»¶ä¸­å¿ƒã€‚æ‰€æœ‰çš„è®¢é˜…ä»¥åŠäº‹ä»¶çš„åˆ†å‘ï¼Œéƒ½åœ¨ store é‡Œé¢å¤„ç†äº†ã€‚è€Œå…·ä½“å¦‚ä½•å±•ç¤ºã€è®¡ç®—æ•°æ®ï¼ˆstateï¼‰ï¼Œæ˜¯ç”¨æˆ·ä¼ å…¥çš„ reducer å†³å®šçš„ã€‚å…³äº store å’Œ component çš„ç»“åˆï¼Œé€šè¿‡ react-redux ä¸­çš„ä¸¤ä¸ªç»„ä»¶ï¼Œå°±å¯ä»¥å¾ˆå¥½çš„è§£å†³äº†ï¼Œconnect ä¹Ÿçš„ç¡®æ˜¯ hocï¼Œä½ åªéœ€è¦å‘Šè¯‰å®ƒä½ ç”¨ä»€ä¹ˆå±æ€§ï¼Œå®ƒå°±å¸®ä½ è‡ªåŠ¨å¤„ç† reaction çš„ re-renderã€‚")]),t._v(" "),a("h2",{attrs:{id:"ç‰¹ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç‰¹ç‚¹"}},[t._v("#")]),t._v(" ç‰¹ç‚¹")]),t._v(" "),a("p",[t._v("æ€»ç»“äº†å‡ ä¸ªï¼š")]),t._v(" "),a("ul",[a("li",[t._v("CQRS\nå‘½ä»¤ä¸æŸ¥è¯¢èŒè´£åˆ†ç¦»ï¼Œè¯´å®è¯è¿™ä¸ªæ¦‚å¿µè·Ÿ redux æœ‰å…³æ˜¯åœ¨çŸ¥ä¹çš„æŸä¸ªé—®ç­”çœ‹åˆ°çš„ã€‚å½“æŠŠ redux çš„ store çœ‹åšä¸€ä¸ª model çš„æ—¶å€™ï¼Œä¹‹å‰å¯¹ model çš„æŸ¥è¯¢ã€å‘½ä»¤ï¼ˆå¢åˆ æ”¹ï¼‰å¯¹åº”çš„å°±åƒ redux é‡Œ çš„ reducerã€action ã€‚ä¸è®¨è®ºè¿™ä¸¤è€…åˆ°åº•æœ‰ä½•å†…åœ¨çš„è”ç³»ï¼Œç¼–ç¨‹çš„æ€æƒ³æœ¬æ¥å°±æ˜¯ç›¸åŒçš„ã€‚å¦‚æœä½ æœ‰å…´è¶£ï¼Œä½ ä¹Ÿå¯ä»¥äº†è§£ä¸€ä¸‹ Event Sourcing å’Œ DDDï¼Œéƒ½ä¼šæ‰¾åˆ°è·Ÿ redux ç›¸ä¼¼çš„å½±å­ã€‚"),a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/25383827",target:"_blank",rel:"noopener noreferrer"}},[t._v("æ¨è"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("å•å‘æ•°æ®æµ\nä» flux å¼€å§‹æå‡ºï¼Œä¹Ÿæ˜¯ç›®å‰çŠ¶æ€ç®¡ç†æ¯”è¾ƒå–œæ¬¢é‡‡ç”¨çš„ï¼Œå› ä¸ºç®€å•æ¸…æ™°çš„æ•°æ®æµå‘ã€‚")]),t._v(" "),a("li",[t._v("å¾ˆå¤šå‡½æ•°å¼çš„æ€æƒ³ã€‚æ¯”å¦‚ Reducerï¼ŒImmutable Dataï¼ŒPure Funcï¼ŒRedux å†…éƒ¨å®ç°ï¼Œ compose ç­‰ã€‚")]),t._v(" "),a("li",[t._v("é€šè¿‡ state çš„å¼•ç”¨å˜åŒ–ï¼Œåˆ¤æ–­æ˜¯å¦æ›´æ–°ç»„ä»¶ã€‚\næ—¢ç„¶ state çš„ä¸å¯å˜æ•°æ®ï¼ŒåŸºäºæ­¤ç†è®ºåŸºç¡€ï¼Œä½¿ç”¨æœ€ç®€å•çš„æ¯”è¾ƒæ•°æ®å¼•ç”¨ï¼Œå»åˆ¤æ–­æ˜¯ä¸æ˜¯è¦æ›´æ–° viewã€‚")]),t._v(" "),a("li",[t._v("å¤©ç”Ÿæ”¯æŒæ—¶é—´å›æº¯\nå› ä¸ºæ¯æ¬¡çš„ state éƒ½æ˜¯æ–°çš„å¼•ç”¨ï¼Œä¸Šä¸€æ¬¡çš„ state è¿˜å¯ä»¥ä¿å­˜ï¼Œæ„Ÿè§‰ä¸Šæ˜¯æœ‰äº†åŸºç¡€ï¼Œå®é™…è¦åšå¾ˆå¤šå·¥ä½œã€‚å¯ä»¥å€Ÿé‰´ redux-devtools ã€‚")]),t._v(" "),a("li",[t._v("ä¸­é—´ä»¶æ‹“å±•\nredux æœ€å¼ºå¤§çš„åœ°æ–¹ä¾¿åœ¨äºä¸­é—´ä»¶çš„æ‹“å±•ã€‚æœ‰ä¸€å¥è¯å«â€œå¥½çš„è®¾è®¡ä¸å¦‚å¥½çš„æ‹“å±•æ€§â€ã€‚")])]),t._v(" "),a("h2",{attrs:{id:"ä¸€äº›é—®é¢˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€äº›é—®é¢˜"}},[t._v("#")]),t._v(" ä¸€äº›é—®é¢˜")]),t._v(" "),a("p",[t._v("è¿™æ˜¯è¦æåŠçš„é‡ç‚¹ã€‚åœ¨å­¦ä¹ å’Œä½¿ç”¨ redux çš„æ—¶å€™ï¼Œé‡åˆ°äº†å¾ˆå¤šçš„é—®é¢˜ï¼Œæ€»ç»“æ¥å°±æ˜¯ä»¥ä¸‹å››ç‚¹ï¼Œç›¸ä¿¡å¤§å®¶ä¹Ÿä¼šç¢°åˆ°...")]),t._v(" "),a("p",[t._v("çº¦å®šå¤šã€ç†è§£éš¾")]),t._v(" "),a("p",[t._v("èƒ¶æ°´ä»£ç ")]),t._v(" "),a("p",[t._v("Effects")]),t._v(" "),a("p",[t._v("æ‰‹åŠ¨ä¼˜åŒ–")]),t._v(" "),a("h2",{attrs:{id:"çº¦å®š"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#çº¦å®š"}},[t._v("#")]),t._v(" çº¦å®š")]),t._v(" "),a("p",[t._v("å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œä¸€å †çš„çº¦å®šçœ‹ç€å°±å¤´å¤§ï¼Œä¹Ÿä¸çŸ¥é“ä¸ºå•¥è¿™ä¹ˆå†™ã€‚å¤§æ¦‚åˆ—ä¸¾å‡ ä¸ªï¼š")]),t._v(" "),a("ul",[a("li",[t._v("ä¸‰å¤§åŸåˆ™ï¼Œstore å”¯ä¸€ï¼Œstate åªè¯»ï¼Œ reducer çº¯å‡½æ•°ã€‚\nè¿™ä¸ªæ˜¯å­¦ä¹  redux åˆæœŸå°±çƒ‚ç†Ÿäºå¿ƒçš„æ¦‚å¿µäº†ï¼Œå‡ ä¹æ‰€æœ‰ redux ç›¸å…³çš„å…¥é—¨æ•™ç¨‹ï¼Œéƒ½ä¼šæœ‰è¿™æ ·çš„ä»‹ç»ï¼Œæ€»ä¹‹ï¼Œå°±ç®—ä¸æ˜ç™½ï¼Œä¹Ÿè®°ä½äº†ã€‚é¦–å…ˆï¼Œstore è®¾è®¡æˆå”¯ä¸€çš„å¯¹è±¡ï¼Œä¸€ä¸ªå¯¹è±¡èƒ½å¸¦æ¥å¾ˆå¤šå®ƒç®€å•çš„ç‰¹ç‚¹ï¼Œæ¯”å¦‚æ‰€æœ‰çš„ reducer è®¡ç®—éƒ½åˆå¹¶åˆ°è¿™ä¸ª storeï¼Œæ‰€æœ‰çš„ç»„ä»¶ä¿®æ”¹ï¼Œæ³¨å…¥éƒ½æ˜¯åŸºäºè¿™ä¸€ä¸ªå¯¹è±¡ï¼›åˆå§‹åŒ–åŒæ„åº”ç”¨çš„çŠ¶æ€ï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰ä¹Ÿæ›´æ–¹ä¾¿ï¼ŒæœåŠ¡ç«¯ç›´æ¥æŒ‚è½½ä¸€ä¸ª "),a("code",[t._v("__ initalStore__")]),t._v(" å°±å¯ä»¥äº†ã€‚state åªè¯»æœ‰å‡½æ•°å¼çš„æ„Ÿè§‰ï¼Œå¦å¤–ä¹Ÿæ˜¯å•å‘æ•°æ®æµçš„å…³é”®ï¼Œä½ ä¸èƒ½ç›´æ¥ä¿®æ”¹ state å¯¹è±¡ï¼Œåªå¯ä»¥é€šè¿‡ action å»ä¿®æ”¹ï¼Œè¿™ä¸ªè·Ÿ flux æ˜¯ç›¸ä¼¼çš„æ€æƒ³ã€‚reducer æ˜¯çº¯å‡½æ•°ï¼Œä¹Ÿæ¥è‡ªäº FPã€‚ä¸èƒ½æœ‰å‰¯ä½œç”¨çš„æ“ä½œï¼Œé€šå¸¸æ˜¯ state çš„ä¸€äº›é‡ç»„ï¼Œæ‹·è´å’Œè®¡ç®—ã€‚ä½¿ç”¨ reduxï¼Œä¼šæœ‰å¾ˆå¤šå‡½æ•°å¼çš„æ€æƒ³ï¼Œæ‰€ä»¥å¾ˆå¤šäººéƒ½ä¼šå­¦ä¸€æ³¢å‡½æ•°å¼ï¼Œæ¯”å¦‚è¯´... "),a("a",{attrs:{href:"https://github.com/sunyongjian/FP-Code/tree/master/src",target:"_blank",rel:"noopener noreferrer"}},[t._v("FP-Code"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("å»ºè®®ç”¨å•ç‹¬çš„æ–‡ä»¶å­˜æ”¾ actionï¼›ä¸è¦å®šä¹‰ action å¯¹è±¡ï¼Œè¦ç”¨ actionCreator åˆ›å»ºã€‚\n"),a("img",{attrs:{alt:"dispatch",width:"570",src:"https://user-images.githubusercontent.com/18378034/35388243-ed9695ba-020d-11e8-8ff7-0a36df466aa2.png"}}),t._v("\nä¸ºäº†ä¸è®©å­ç»„ä»¶æ„Ÿå—åˆ° redux çš„å­˜åœ¨ï¼Œé€šè¿‡ bindActionCreators ç”Ÿæˆè¿™ç§ "),a("code",[t._v("() =dispatch(actionCreator);")]),t._v(" å½¢å¼çš„ functionã€‚ å¦‚ä¸Šå›¾ï¼Œæœ€åå¯èƒ½å°±æ˜¯ increase è¿™æ ·çš„ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åç»„ä»¶å†…éƒ¨å»è°ƒç”¨æ­¤æ–¹æ³•ï¼Œæ¯”å¦‚ç”¨ connect è¿™æ ·çš„ç»„ä»¶æ³¨å…¥ actions æ–¹æ³•ã€‚æœ€å¼€å§‹å†™ redux çš„æ—¶å€™ï¼Œè§è¿‡å¾ˆå¤šäººåœ¨ç»„ä»¶å†…éƒ¨è°ƒç”¨ dispatch æ–¹æ³•çš„ï¼Œå› ä¸º connect çš„ç¬¬äºŒä¸ªå‚æ•° "),a("code",[t._v("MapDispatchToProps")]),t._v(" ä¸ä¼ çš„æ—¶å€™ï¼Œå®ƒä¼šé»˜è®¤æŠŠ dispatch æ–¹æ³•ä¼ ä¸‹æ¥ã€‚ç„¶åå°±ç›´æ¥åœ¨ç»„ä»¶å†…éƒ¨å†™ "),a("code",[t._v("dispatch({ type: â€™INCREASEâ€˜})")]),t._v(" è¿™æ ·çš„ä»£ç ï¼Œè¿™è·Ÿä½¿ç”¨ bindActionCreator çš„å°±å½¢æˆäº†ä¸åŒçš„é£æ ¼ã€‚å¦å¤–ï¼Œå¤§é¡¹ç›®ä¸­æ˜¯ä¸å»ºè®®ç»„ä»¶ç›´æ¥ç”¨ dispatch æ–¹æ³•çš„ï¼Œredux å»ºè®®çš„æ˜¯ smart + dumbï¼Œå³æœ‰ä¸€ä¸ª container ç»„ä»¶è·Ÿ redux åšäº¤æ˜“ï¼Œä¸‹é¢çš„ç»„ä»¶è¦åšæˆå¯å¤ç”¨çš„ï¼Œè·Ÿ redux æ— å¼ºè€¦åˆçš„ç»„ä»¶... æ‰€ä»¥ï¼Œç†è§£çš„  actionCreator çš„ä½œç”¨å¤§æ¦‚æ˜¯è¿™æ ·ã€‚")]),t._v(" "),a("li",[t._v("reducer å¼ºè°ƒçº¯å‡½æ•°ï¼Œè®¡ç®—ã€‚è¿”å›æ–°çš„ stateã€‚\nè¿”å›æ–°çš„ stateï¼ˆredux ä¸­çš„ state æ¦‚å¿µç†è§£ä¸º reducer è¿”å›çš„è®¡ç®—ç»“æœï¼‰ï¼Œæ„å‘³ç€ä¸å¯å˜æ•°æ®ï¼Œä¸å¯å˜æ•°æ®æ“ä½œå°±è®¾è®¡åˆ°ä¸€ä¸ªæ‹·è´çš„é—®é¢˜ã€‚æ·±æµ…æ‹·è´çš„æ–¹æ³•ï¼Œæ·±æ‹·è´çš„æ€§èƒ½é—®é¢˜ï¼ŒèŠ‚çº¦å†…å­˜ç­‰ã€‚å¯èƒ½ä¼šå¼•å…¥ immutable è¿™æ ·çš„åº“ï¼Œåˆå¢åŠ äº†ä»£ç å¤æ‚åº¦ï¼Œä¾µå…¥æ€§è¾ƒå¼ºï¼Œè€Œä¸”ä¸æ˜¯ plainObjectï¼Œå­˜åœ¨è½¬æ¢é—®é¢˜ï¼Œå¯èƒ½ä¼šå¼•å…¥ "),a("a",{attrs:{href:"https://github.com/indexiatech/redux-immutablejs",target:"_blank",rel:"noopener noreferrer"}},[t._v("redux-immutable"),a("OutboundLink")],1),t._v(" ä¸­çš„ combineReducers å»å¤„ç†ï¼Œå†…éƒ¨åšè½¬æ¢ã€‚ã€‚ã€‚æ€»ä¹‹è§£å†³çš„æ–¹æ¡ˆæ€»æ˜¯æœ‰ï¼Œåªæ˜¯æœ‰ä¸€å®šçš„æˆæœ¬ã€‚redux ç¤¾åŒºæ‰äººè¿˜æ˜¯å¾ˆå¤šçš„ã€‚")]),t._v(" "),a("li",[t._v("state è®¾è®¡çš„å°½é‡æ‰å¹³ï¼Œæœ€å¤šä¸¤ä¸‰å±‚ã€‚\nåµŒå¥—å¤ªå¤šå±‚çš„è¯ï¼Œå–å€¼çš„æ—¶å€™æ¯”è¾ƒéº»çƒ¦ï¼Œä¹Ÿéœ€è¦æœ‰å®¹é”™å¤„ç†ï¼ˆå½“ç„¶æ¥ä¸€ä¸ª lodash å°±å¥½äº†ï¼‰ã€‚è¿™åªæ˜¯æŸä¸ª state çš„å±‚çº§è®¾è®¡é—®é¢˜ã€‚è¿˜æœ‰å¯¹æ•´ä¸ª store çš„è®¾è®¡ï¼Œæ¯”å¦‚æ ¹æ®æ¨¡å—åˆ’åˆ†ï¼Œå…±äº«çš„çŠ¶æ€å’Œç§æœ‰çš„åŒºåˆ†ã€‚è°ˆåˆ°è¿™ï¼Œåˆå¼•ç”³å‡ºä»€ä¹ˆæ ·çš„çŠ¶æ€è¯¥æ”¾åˆ° redux ä¸­ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç”¨ redux å¾ˆå¥½çš„å¤„ç†äº†å¤æ‚çš„å¼‚æ­¥é€»è¾‘é—®é¢˜ï¼Œæ‰€ä»¥å¤æ‚çš„ Effect æ¨èæ”¾åˆ° reduxã€‚å¦å¤–å°±æ˜¯ä¸€äº›éœ€è¦å…±äº«çš„ï¼Œæ¯”å¦‚ userInfoï¼ŒAppStateï¼Œç‰¹æ®Šçš„ç•Œé¢çŠ¶æ€ã€‚")])]),t._v(" "),a("p",[t._v("è¿™é‡Œæ€»ç»“äº†ä¸€äº›ä½¿ç”¨ redux çš„æ—¶å€™ï¼Œå®˜ç½‘å’Œç¤¾åŒºæ¨èçš„ä¸€äº›è§„èŒƒæˆ–è€…çº¦å®šã€‚å¦‚æœéµå®ˆçº¦å®šè¿˜å¥½ï¼Œå¦‚æœé£æ ¼ä¸ä¸€çš„è¯ï¼Œå…¶å®è¿™äº›çº¦å®šå°±å¤±å»äº†åŸæœ¬çš„æ„ä¹‰äº†ã€‚å…¶å®æ›´æƒ³è¡¨è¾¾çš„æ˜¯ï¼Œå¯¹äºæ–°æ‰‹æ¥è¯´ï¼Œå­¦ä¹ æˆæœ¬çœŸçš„æŒºé«˜çš„ã€‚ç„¶åå°±æ˜¯ Effects çš„ä¸€äº›é—®é¢˜ã€‚")]),t._v(" "),a("h2",{attrs:{id:"effects"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#effects"}},[t._v("#")]),t._v(" Effects")]),t._v(" "),a("p",[t._v("è¿™é‡Œçš„ Effects ä¸»è¦æŒ‡å¼‚æ­¥è¯·æ±‚ã€‚æœ€å¼€å§‹çš„æ–¹å¼æ˜¯å¼•å…¥ redux-thunkï¼Œredux-promise è¿™æ ·çš„ä¸­é—´ä»¶ï¼Œå»æ”¹é€  store çš„åŸç”Ÿ dispatch æ–¹æ³•ï¼ˆcompose å½¢æˆçš„å‡½æ•°è°ƒç”¨é“¾ï¼‰ï¼Œä½¿å¾—å®ƒçš„å‚æ•°ä¸å†å±€é™äºä¸€ä¸ª action å¯¹è±¡ï¼Œè€Œæ˜¯å¯ä»¥æ¥æ”¶ function æˆ–è€… promise å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸€å±‚æŠŠ Effect å½±å“å»é™¤ï¼Œå˜æˆåŸæ¥çš„ dispatch ä¸€ä¸ª action å¯¹è±¡ï¼ˆä»£ç å±‚é¢å°±æ˜¯ç»è¿‡å‡½æ•°è°ƒç”¨é“¾ï¼Œæœ€åæ‰§è¡ŒåŸæ¥çš„ dispatch æ–¹æ³•ï¼‰ã€‚å¦‚ä¸‹å›¾ï¼š")]),t._v(" "),a("img",{attrs:{alt:"thunk1",width:"683",src:"https://user-images.githubusercontent.com/18378034/35396242-4bd19a12-0227-11e8-94e0-9420cc9f2b6e.png"}}),t._v(" "),a("p",[t._v("å¼•å…¥ thunk åçš„æ•°æ®æµå‘å¤§æ¦‚æ˜¯è¿™æ ·çš„ã€‚ç»„ä»¶å†…éƒ¨é€šè¿‡äº‹ä»¶æˆ–è€…ç”Ÿå‘½å‘¨æœŸï¼Œå»è°ƒç”¨ hoc æ³¨å…¥è¿›æ¥çš„ actions æ–¹æ³•ï¼Œé€šå¸¸æ˜¯é€šè¿‡ actionCreator åˆ›å»ºçš„ã€‚ç”±äºä¸­é—´ä»¶çš„æœºåˆ¶ï¼Œå¯ä»¥åœ¨ actionCreator ä¸­ return ä¸€ä¸ªæ–°çš„ functionï¼Œè‡ªç„¶è€Œç„¶çš„ï¼Œå¼‚æ­¥ä»£ç å’Œä¸€äº›é€»è¾‘å°±å†™åœ¨äº†è¿™é‡Œï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­é»„è‰²æ ‡è®°çš„ã€‚æ¯”å¦‚ request ä¸€ä¸ªè¯·æ±‚ï¼Œå½“ response çš„æ—¶å€™ï¼Œå†æ‰§è¡Œ dispatch æ–¹æ³•ï¼ŒæŠŠè¿”å›çš„ data ä¼ é€’åˆ° reducerã€‚reducer é€šè¿‡è®¡ç®—ã€æ‹·è´ï¼Œåˆå¹¶ç”Ÿæˆæ–°çš„ state treeï¼Œç„¶åä¼šæ‰§è¡Œ listenersï¼Œæ— è®ºä½ æ˜¯é€šè¿‡ connect è¿˜æ˜¯è®¢é˜…çš„æ–¹å¼ï¼Œæ€»ä¹‹ä½ çš„ç»„ä»¶ä¼š re-render äº†ï¼Œæ¥æ”¶æ–°çš„ stateã€‚å¤§æ¦‚çš„æµç¨‹å¤§å®¶éƒ½å¾ˆæ¸…æ¥šäº†åº”è¯¥ï¼Œé—®é¢˜åœ¨äºå®é™…ä¸šåŠ¡ä¸­ï¼ŒactionCreator è¿™é‡Œä¼šæœ‰å¾ˆå¤šé€»è¾‘ä»£ç ï¼Œå¼€å§‹å¯èƒ½æŠŠæœ€åŸºæœ¬çš„ fetchï¼Œloadingï¼Œerror çš„ catch è¿™æ ·çš„ä¸œè¥¿é€šè¿‡ function å°è£…ï¼Œå»è§£å†³æœ€é€šç”¨çš„åœºæ™¯ã€‚ä¸è¿‡æ¶‰åŠåˆ°å¤æ‚çš„ä¸šåŠ¡ï¼Œå°±ä¼šåœ¨ then ä¸­å‡ºç°å¾ˆå¤šçš„ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œæ¯”å¦‚æœ‰æ—¶å€™éœ€è¦è½®è¯¢çš„æœºåˆ¶ï¼Œæœ‰æ—¶å€™éœ€è¦ dispatch å¤šä¸ª actionï¼Œå¤„ç†èµ·æ¥ä¸é‚£ä¹ˆé¡ºæ‰‹ï¼Œè€Œä¸”actionCreator ä¸­çš„ä»£ç è¶Šæ¥è¶Šå¤šï¼Œä¸å†æ˜¯ä¸€ä¸ªç®€å•çš„ functionï¼Œaction ä¸å†çº¯å‡€ï¼Œè¿èƒŒäº†å®ƒçš„åŸæ„ã€‚æ‰€ä»¥ saga å‡ºç°äº†ã€‚\n"),a("img",{attrs:{alt:"saga1",width:"662",src:"https://user-images.githubusercontent.com/18378034/35396246-4e606826-0227-11e8-8bb8-d606d3e203d7.png"}})]),t._v(" "),a("p",[t._v("saga å…¨å±€ä¸‹è·‘ç€ generatorï¼Œéœ€è¦ watch çš„ actionTypeï¼Œé€šå¸¸æ˜¯ async çš„ï¼Œç”¨ takeEvery æˆ–è€… takeLatest è¿™æ ·çš„æ–¹æ³•åšç›‘å¬ï¼Œå¦‚ "),a("code",[t._v("yield* takeEvery('FETCH_REQUESTED', fetchData)")]),t._v("ï¼Œå½“ type åŒ¹é…åˆ° "),a("code",[t._v("FETCH_REQUESTED")]),t._v("ï¼Œå°±ä¼šè¿›å…¥ sagaï¼Œæ‰§è¡Œ fetchDataï¼ˆsaga ä¸­æ¯ä¸ªå¼‚æ­¥ä»»åŠ¡è¢«å®šä¹‰ä¸º Effectï¼‰ï¼Œä¸åŒ¹é…çš„å°±ä»ç„¶èµ°åˆ° reducerã€‚è·Ÿ thunk ä¸åŒçš„æ˜¯å¼‚æ­¥ä»£ç å†™åˆ°äº† saga ä¸­ï¼Œä¹Ÿæ˜¯å›¾ä¸­æ ‡é»„çš„ã€‚æ•´ä¸ªæµç¨‹çœ‹èµ·æ¥æ›´æ¸…æ™°ï¼Œæ¯ä¸€éƒ¨åˆ†çš„èŒè´£å•ä¸€ï¼Œ actionCreator å’Œ Effectã€ä¸šåŠ¡é€»è¾‘ä¹Ÿè§£è€¦äº†ã€‚å¤šäººå¼€å‘çš„å¤§å‹é¡¹ç›®ä¸­ï¼Œè¿™æ ·çš„ä»£ç ç»„ç»‡çš„ç¡®æ˜¯å¯è¯»æ€§æ›´é«˜ï¼Œå¦‚æœä½ å¯¹æ•´ä¸ªæ•°æ®æµæ¯”è¾ƒæ¸…æ™°ï¼Œä¾¿å¯ä»¥å¾ˆå¿«å®šä½åˆ°ä»£ç ã€‚å½“ç„¶ saga çš„ä¼˜åŠ¿ä¸æ­¢è¿™ä¸€ç‚¹ï¼Œå®ƒè¿˜å°è£…äº†ä¸€äº›å¤æ‚çš„ä¸šåŠ¡åœºæ™¯ã€‚æ¯”å¦‚æŸä¸ªå¼‚æ­¥ä»»åŠ¡è°ƒç”¨å¤šæ¬¡çš„æ—¶å€™ï¼Œsaga å¯ä»¥ takeLatestï¼Œä¹Ÿå°±æ˜¯åªä¿ç•™æœ€æ–°çš„ä»»åŠ¡ï¼Œè€Œ thunk æ˜¯æ¯”è¾ƒéš¾å¤„ç†çš„ï¼Œä¹‹å‰çš„ä»»åŠ¡ä¸å®¹æ˜“å–æ¶ˆã€‚å¦å¤– saga ä¹Ÿæä¾›äº† cancel çš„ API å¯ä»¥å–æ¶ˆ taskã€‚å®ƒè¿˜å°è£…äº†ä¸€äº› "),a("code",[t._v("promise.all, promise race")]),t._v(" çš„åŠŸèƒ½ï¼Œä¹Ÿé»˜è®¤æ”¯æŒå µå¡å’Œéå µå¡çš„è°ƒç”¨ã€‚æ€»ä¹‹ï¼Œå¼‚æ­¥å¤„ç†çš„å¾ˆå¤šå¸¸è§å®ƒéƒ½å¸®æƒ³åˆ°äº†ï¼Œå¥½å¥½çœ‹çœ‹æ–‡æ¡£ï¼Œä½ ä¾¿å¯ä»¥å¾ˆå®¹æ˜“å¹¶ä¸”å¾ˆä¼˜é›…çš„å†™å‡ºç›¸å…³ä»£ç ã€‚")]),t._v(" "),a("p",[t._v("ä¸è¿‡ saga ä¹Ÿæœ‰ä¸€äº›é—®é¢˜ã€‚æ¯”å¦‚é”™è¯¯çš„ catchï¼ŒåŸºæœ¬éœ€è¦æ¯ä¸ª task è¦åŠ ä¸€ä¸ª try catchï¼Œä¸ç„¶æœ€å saga æŠ›å‡ºçš„é”™ï¼Œä½ æ ¹æœ¬ä¸çŸ¥é“æ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜ï¼Œè°ƒè¯•ä¸å°½äººæ„ï¼Œbabel çš„ source-map æœ‰æ—¶ä¹Ÿä¼šå®šä½å¤±è¯¯ã€‚è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ä¾¿æ˜¯ï¼Œredux æœ¬æ¥å®šä¹‰çš„æ–‡ä»¶å°±å¤Ÿå¤šäº†ï¼Œåˆå‡ºç°äº†ä¸€ä¸ª sagaï¼Œæ„Ÿè§‰åƒæ˜¯æŠŠ actionCreator é‡Œçš„å¼‚æ­¥ä»£ç æ¢äº†ä¸ªåœ°æ–¹è€Œå·²ã€‚å¦å¤–ï¼Œæœ€å¼€å§‹çš„é‡å¤çš„ä»£ç ä¹Ÿå¾ˆå¤šï¼Œé‡å¤çš„ç›‘å¬ saga ä»»åŠ¡ï¼Œcall Effectï¼Œput actionï¼Œä¾¿åˆéœ€è¦å°è£…ä¸€ä¸ªé€šç”¨çš„ fetchSaga çš„æ–¹æ³•ï¼Œå»å¤„ç†å¸¸è§çš„å¼‚æ­¥ä»»åŠ¡ã€‚å¼•å…¥ saga çš„å¥½å¤„æ˜¯ä¼˜é›…çš„å¤„ç†çš„å¼‚æ­¥ actionï¼Œæä¾›çš„ API ä¹Ÿå¾ˆå¼ºå¤§ã€‚ä½†æ˜¯å¼•å…¥ä¸€æ–¹é¢æ˜¯å­¦ä¹ æˆæœ¬ï¼Œä¸€æ–¹é¢åˆæ˜¯å°è£…çš„æ—¶é—´æˆæœ¬ï¼Œè¿™éƒ½æ˜¯é¡¹ç›®é€‰å‹éœ€è¦è€ƒè™‘çš„ã€‚å¦‚æœä½ çš„é¡¹ç›®æœ‰å¤§é‡çš„è¯»å–æ“ä½œï¼Œè½®è¯¢çš„çŠ¶æ€ï¼Œæ¯”è¾ƒéº»çƒ¦çš„å¼‚æ­¥ä»»åŠ¡ï¼Œé‚£å¼•å…¥ saga å¸¦æ¥çš„æ•ˆæœæ˜¯æ¯”è¾ƒæ˜æ˜¾çš„ã€‚åä¹‹ï¼Œåˆ™æ˜¯å¢åŠ äº†å¼€å‘å’Œç»´æŠ¤æˆæœ¬ï¼Œè¿˜æ˜¯è¦æ³¨æ„åœºæ™¯ã€‚å¯¹ saga çš„ç ”ç©¶ä¹Ÿæ²¡æœ‰ç‰¹åˆ«æ·±å…¥ï¼Œä¸å†è¿‡å¤šèµ˜è¿°äº†ï¼Œç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šçš„æ–‡ç« ï¼Œæ¨èå‡ ä¸ªï¼š\n"),a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/23012870",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.redux-saga å®è·µæ€»ç»“"),a("OutboundLink")],1),t._v("ï¼Œ 2.")]),t._v(" "),a("h2",{attrs:{id:"èƒ¶æ°´ä»£ç "}},[a("a",{staticClass:"header-anchor",attrs:{href:"#èƒ¶æ°´ä»£ç "}},[t._v("#")]),t._v(" èƒ¶æ°´ä»£ç ")]),t._v(" "),a("p",[t._v("redux çš„èƒ¶æ°´ä»£ç ä¹Ÿæ˜¯å¼€å‘æ—¶æ¯”è¾ƒç—›è‹¦çš„åœ°æ–¹ã€‚")]),t._v(" "),a("ul",[a("li",[t._v("actionsã€reducersã€actionTypes éƒ½è¦å®šä¹‰\nåœ¨ä½¿ç”¨ redux çš„é¡¹ç›®ä¸­ï¼Œå½“ä½ è¦å…±äº«çŠ¶æ€æˆ–è€…å¤„ç†å¼‚æ­¥çš„æ—¶å€™ï¼Œå‡å¦‚è¯´æ”¾åˆ° redux ä¸­ï¼Œå°±ä¸å¾—ä¸å®šä¹‰ä¸€å †ç±»ä¼¼çš„æ–‡ä»¶ã€‚æœ‰çš„äººè§‰å¾—è¿™æ˜¯æ¯”è¾ƒå¥½çš„çº¦æŸå’Œè§„èŒƒï¼Œè€Œæœ‰çš„äººå°±è§‰å¾—è¿™ç§å½¢å¼æ¯”è¾ƒç¹çï¼Œè¿™ä¸ªé—®é¢˜å°±ä»è€…è§ä»æ™ºè€…è§æ™ºäº†ã€‚")]),t._v(" "),a("li",[t._v("saga é‡Œé¢çš„å„ç§ yield  =å°è£…")])]),t._v(" "),a("p",[t._v("å…³äºè¿™ä¸€éƒ¨åˆ†ï¼Œç¤¾åŒºä¹Ÿæœ‰å¾ˆå¤šæ–¹æ¡ˆï¼Œæ¯”è¾ƒæˆç†Ÿçš„ dvaï¼Œ å°è£…çš„å·²ç»å¾ˆå¥½äº†ï¼ŒæŠŠ actionsã€reducersã€actionTypes ä»¥ model çš„æ¦‚å¿µå°è£…ï¼Œå°½ç®¡ redux æœ¬æ¥ model çš„æ¦‚å¿µå¾ˆå¼±ã€‚saga çš„ä¹Ÿå°è£…åˆ°äº† effects ä¸­ã€‚")]),t._v(" "),a("h2",{attrs:{id:"æ‰‹åŠ¨ä¼˜åŒ–"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ‰‹åŠ¨ä¼˜åŒ–"}},[t._v("#")]),t._v(" æ‰‹åŠ¨ä¼˜åŒ–")]),t._v(" "),a("p",[t._v("è·Ÿå¤§éƒ¨åˆ†æŠ€æœ¯æ ˆä¸€æ ·ï¼Œredux ä¹Ÿéœ€è¦æ‰‹åŠ¨è°ƒä¼˜ï¼Œä¸‹é¢æ˜¯æ€»ç»“çš„å‡ ä¸ªï¼š")]),t._v(" "),a("ul",[a("li",[t._v("mapStateToProps é‡‡ç”¨ "),a("a",{attrs:{href:"https://github.com/reactjs/reselect",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reselect"),a("OutboundLink")],1),t._v(" åšç¼“å­˜\nå½“ä½ é‡‡ç”¨ connect å»ç»™ç»„ä»¶æ³¨å…¥ state çš„æ—¶å€™ï¼Œéœ€è¦ mapStateToProps å‡½æ•°å»æŒ‡å®šä½ éœ€è¦çš„ stateã€‚è€Œè¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¯èƒ½ä½ è¿™ä¸ªç»„ä»¶åªä½¿ç”¨äº†æŸä¸ª stateï¼Œä½†æ˜¯å…¶ä»–æ— å…³çš„ action è§¦å‘çš„æ—¶å€™ï¼ŒmapState å‡½æ•°éƒ½ä¼šé‡æ–°æ‰§è¡Œè®¡ç®—ã€‚åœ¨è¿™é‡Œå°±è¸©è¿‡å‘ï¼Œæ¯”å¦‚çš„ mapState æ˜¯è¿™æ ·çš„ï¼š")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" mapStateToProps "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toJS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("åœ¨ reducer ä¸­æŠŠ data é€šè¿‡ immutablejs å¤„ç†äº†ï¼Œç»„ä»¶ä¸­ä½¿ç”¨çš„æ—¶å€™éœ€è¦ toJS è½¬æ¢æˆåŸç”Ÿå¯¹è±¡ï¼Œè€Œæ¯æ¬¡æ‰§è¡Œè¿”å›çš„éƒ½æ˜¯æ–°å¯¹è±¡ã€‚æ‰€ä»¥æ¯æ¬¡åŒ…è£…åçš„ç»„ä»¶åš shadowEqual çš„æ—¶å€™ï¼Œéƒ½è®¤ä¸º state å‘ç”Ÿå˜åŒ–äº†ï¼Œå¯¼è‡´æ— å…³çš„ action ä¹Ÿä¼šå¼•å‘è¯¥ç»„ä»¶çš„ re-renderã€‚è¿™æ˜¯ç”± connect çš„æœºåˆ¶å†³å®šçš„ï¼Œhoc å†…éƒ¨è°ƒç”¨ store çš„ subscribe å‡½æ•°ï¼Œæ³¨å†Œä¸€ä¸ªäº‹ä»¶ï¼Œå½“ dispatch ä¸€ä¸ª actionï¼Œæ‰€æœ‰ reducer æ‰§è¡Œåï¼Œä¼š pub è¿™ä¸ªäº‹ä»¶ï¼Œæ­¤äº‹ä»¶å°±ä¼šå¯¹æ¯”ä¸¤æ¬¡ state çš„å¼•ç”¨æ˜¯å¦å˜åŒ–ï¼Œå†³å®šç»„ä»¶æ˜¯å¦æ›´æ–° state ä»¥åŠ renderã€‚æ‰€ä»¥è¿™é‡Œæ¯æ¬¡è¿”å›çš„æŸä¸ª state å¦‚æœéƒ½æ˜¯æ–°å¼•ç”¨ï¼Œæ˜¯æœ‰é—®é¢˜ï¼Œå¹¶ä¸” mapStateToProps å‡½æ•°ä¹Ÿä¸åº”è¯¥å­˜æ”¾å¤§é‡çš„è®¡ç®—ä»£ç ã€‚")]),t._v(" "),a("p",[t._v("reselect å°±æ˜¯ç”¨æ¥è§£å†³ä¸Šè¿°é‡å¤è®¡ç®—çš„é—®é¢˜çš„ï¼Œå…¶å® reselect å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªç¼“å­˜å‡½æ•°ï¼Œå½“ä½ åšè¿‡ä¸€æ¬¡è®¡ç®—æˆ–è€…å¤„ç†ï¼Œè¯¥ç»“æœè¢«ç¼“å­˜åˆ°å“ˆå¸Œè¡¨ï¼ˆå°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼‰ä¸­ï¼Œä¸‹æ¬¡é‡åˆ°åŒæ ·çš„è¾“å…¥ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­è°ƒå–ï¼Œå°±ä¸ç”¨é‡æ–°è®¡ç®—äº†ï¼Œä¹Ÿå°±ä¸ä¼šæœ‰å‘ï¼Œæ•ˆç‡ä¹Ÿå¥½ä¸€äº›ã€‚ä¸€ä¸ªç¼“å­˜å‡½æ•°ç±»ä¼¼äºè¿™æ ·ï¼š")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" memoize "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" cache "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("cache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      cache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("f")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" cache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" capitalized "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("slice")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toUpperCase")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("slice")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" memoCap "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("memoize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("capitalized"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("p",[t._v("åˆ©ç”¨å‡½æ•°å¼çš„é«˜é˜¶å‡½æ•°å’Œ js çš„é—­åŒ…å°±å¯ä»¥å®ç°æœ€åŸºæœ¬çš„ç¼“å­˜å‡½æ•°ï¼Œç®€å•æ¥è¯´ï¼Œreselect å°±æ˜¯è¿™æ ·çš„åŸç†ã€‚å½“ä½  f çš„ç»“æœéœ€è¦çš„è®¡ç®—è¶Šå¤šï¼Œæ‰§è¡Œçš„ä»£ç è¶Šå¤šï¼Œç¼“å­˜çš„æ„ä¹‰å°±è¶Šå¤§ã€‚")]),t._v(" "),a("ul",[a("li",[t._v("æœ‰æ—¶å€™éœ€è¦ SCU å¡« state è®¾è®¡ä¸åˆç†çš„å‘\nReact ç»„ä»¶æœ¬èº«å°±æ‹¥æœ‰ shouldUpdate çš„èƒ½åŠ›ï¼Œæ¯”å¦‚ç»„ä»¶ state çš„å¼•ç”¨æ˜¯å¦å˜åŒ–ã€‚å¦å¤–ï¼ŒReact ä¹Ÿæä¾›äº† shouldComponentUpdate è¿™æ ·çš„å‡½æ•°ï¼Œè®©ä½ å¯ä»¥è‡ªå·±æ§åˆ¶ update çš„ç»†åº¦ã€‚\n------------------------------------------åˆ†å‰²çº¿------------------------------------------------")]),t._v(" "),a("li",[t._v("pureComponent   shallowEqual")]),t._v(" "),a("li",[t._v("[ ]  scu çš„ç®€åŒ–ç‰ˆï¼Œæ‰‹åŠ¨ä½œæµ…å±‚æ¯”è¾ƒã€‚")]),t._v(" "),a("li",[t._v("state çš„å±‚æ¬¡è®¾è®¡ï¼Œæ‹·è´ã€è®¾å€¼é—®é¢˜")]),t._v(" "),a("li",[t._v("[ ]  å¯¹åç«¯æ•°æ®æ‹†åˆ†")])]),t._v(" "),a("p",[t._v("thenï¼Œdva å»å°è£…çš„æ€æƒ³æˆ–è®¸æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚try mobx...")]),t._v(" "),a("img",{attrs:{alt:"mobx1",width:"626",src:"https://user-images.githubusercontent.com/18378034/34917637-563952c0-f984-11e7-8c5a-f5bfc18497b2.png"}}),t._v(" "),a("h1",{attrs:{id:"mobx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mobx"}},[t._v("#")]),t._v(" mobx")]),t._v(" "),a("ul",[a("li",[t._v("[ ]  éå¸¸é€‚åˆæ•°æ®é©±åŠ¨çš„åº”ç”¨ã€‚")])]),t._v(" "),a("p",[t._v("redux è¿˜æ˜¯éµå¾ªçš„ setState ä¸€å¥—æµç¨‹ï¼Œmobx æ¨å‡ºçš„æ—¶å€™ï¼Œä¸€ä¸ªä¸»å¼ å°±æ˜¯å¹²æ‰ setState çš„æœºåˆ¶ã€‚")]),t._v(" "),a("p",[a("a",{attrs:{"data-fancybox":"",title:"image",href:"https://user-images.githubusercontent.com/18378034/34917660-6fb4fe8e-f984-11e7-90e3-d5d57d006b70.png"}},[a("img",{attrs:{src:"https://user-images.githubusercontent.com/18378034/34917660-6fb4fe8e-f984-11e7-90e3-d5d57d006b70.png",alt:"image"}})])]),t._v(" "),a("h2",{attrs:{id:"api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#api"}},[t._v("#")]),t._v(" API")]),t._v(" "),a("ul",[a("li",[t._v("[ ]  åªæœ‰äº”ä¸ªã€‚\nObservable\nComputed\nAutonrun\nAction\nObserver")])]),t._v(" "),a("h2",{attrs:{id:"æ•°æ®æµ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®æµ"}},[t._v("#")]),t._v(" æ•°æ®æµ")]),t._v(" "),a("p",[a("a",{attrs:{"data-fancybox":"",title:"image",href:"https://user-images.githubusercontent.com/18378034/34917669-86bd3f24-f984-11e7-9e4a-d4815726752b.png"}},[a("img",{attrs:{src:"https://user-images.githubusercontent.com/18378034/34917669-86bd3f24-f984-11e7-9e4a-d4815726752b.png",alt:"image"}})])]),t._v(" "),a("h2",{attrs:{id:"ä¾èµ–æ”¶é›†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¾èµ–æ”¶é›†"}},[t._v("#")]),t._v(" ä¾èµ–æ”¶é›†")]),t._v(" "),a("ul",[a("li",[t._v("[ ]  mobx æ ¸å¿ƒç‚¹ã€‚")])]),t._v(" "),a("h2",{attrs:{id:"ç”Ÿå‘½å‘¨æœŸ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç”Ÿå‘½å‘¨æœŸ"}},[t._v("#")]),t._v(" ç”Ÿå‘½å‘¨æœŸ")]),t._v(" "),a("ul",[a("li",[t._v("[ ]  åªæœ‰ä¸€ä¸ª componentWillReactï¼Œå½“ç„¶ä¹Ÿä¼šæœ‰ didupdate didmount unmountã€‚")])]),t._v(" "),a("h2",{attrs:{id:"ä¼˜ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¼˜ç‚¹"}},[t._v("#")]),t._v(" ä¼˜ç‚¹")]),t._v(" "),a("ul",[a("li",[t._v("[ ]  æ•°æ®è®¢é˜…é¢—ç²’åº¦é«˜ï¼Œä¸ç”¨åˆ»æ„ç»´æŠ¤æ€§èƒ½\noop å¥½ä¸Šæ‰‹ï¼Œå°‘äº›ä»£ç ")])]),t._v(" "),a("h2",{attrs:{id:"æ€è€ƒğŸ¤”"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ€è€ƒğŸ¤”"}},[t._v("#")]),t._v(" æ€è€ƒğŸ¤”")]),t._v(" "),a("ul",[a("li",[t._v("ä»€ä¹ˆæ—¶å€™ç”¨å•ä¾‹")]),t._v(" "),a("li",[t._v("ä»€ä¹ˆæ—¶å€™ç”¨ class")]),t._v(" "),a("li",[t._v("ä»€ä¹ˆæ—¶å€™æ³¨å…¥åˆ°")]),t._v(" "),a("li",[t._v("toJS")]),t._v(" "),a("li",[t._v("observer ç”¨çš„è¶Šå¤šï¼Œæ•ˆç‡è¶Šé«˜ï¼Œä½†æ˜¯ä¼šå¼ºä¾èµ– mobx")])]),t._v(" "),a("h2",{attrs:{id:"mobx-æ‹“å±•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mobx-æ‹“å±•"}},[t._v("#")]),t._v(" Mobx æ‹“å±•")]),t._v(" "),a("ul",[a("li",[t._v("https://egghead.io/lessons/javascript-sync-the-ui-with-the-app-state-using-mobx-observable-and-observer-in-react æ•™ç¨‹")]),t._v(" "),a("li",[t._v("https://blog.cloudboost.io/3-reasons-why-i-stopped-using-react-setstate-ab73fc67a42e")]),t._v(" "),a("li",[t._v("spy vs logger")]),t._v(" "),a("li",[t._v("æ—¶é—´å›æº¯ https://github.com/mobxjs/mobx-state-tree")]),t._v(" "),a("li",[t._v("å¦‚ä½•å®ç°çš„ä¾èµ–æ”¶é›†ï¼ŒReact ç”Ÿå‘½å‘¨æœŸç¦ç”¨")])]),t._v(" "),a("h1",{attrs:{id:"mobx-redux-æ¯”è¾ƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mobx-redux-æ¯”è¾ƒ"}},[t._v("#")]),t._v(" Mobxï¼ŒRedux æ¯”è¾ƒ")]),t._v(" "),a("h2",{attrs:{id:"ç¤¾åŒº"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç¤¾åŒº"}},[t._v("#")]),t._v(" ç¤¾åŒº")]),t._v(" "),a("p",[a("a",{attrs:{"data-fancybox":"",title:"image",href:"https://user-images.githubusercontent.com/18378034/34917681-bf8dba22-f984-11e7-9d1f-713563827c24.png"}},[a("img",{attrs:{src:"https://user-images.githubusercontent.com/18378034/34917681-bf8dba22-f984-11e7-9d1f-713563827c24.png",alt:"image"}})])]),t._v(" "),a("p",[t._v("ä½¿ç”¨åº¦å…³æ³¨åº¦ï¼Œredux æ›´å¤šï¼Œç¤¾åŒº redux ä¹Ÿæ˜¯å®Œèƒœã€‚")]),t._v(" "),a("h2",{attrs:{id:"ç®€å•å¯¹æ¯”"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç®€å•å¯¹æ¯”"}},[t._v("#")]),t._v(" ç®€å•å¯¹æ¯”")]),t._v(" "),a("ul",[a("li",[t._v("fp vs oop")]),t._v(" "),a("li",[t._v("Elm vs ä¾èµ–æ”¶é›† + å“åº”å¼")]),t._v(" "),a("li",[t._v("å•ä¸€æ•°æ®æº vs å¤šä¸ª store")]),t._v(" "),a("li",[t._v("Readonly vs read & write")]),t._v(" "),a("li",[t._v("Plain objects vs observable data")]),t._v(" "),a("li",[t._v("smart + dumb vs smart")])]),t._v(" "),a("h2",{attrs:{id:"æ€»ç»“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“"}},[t._v("#")]),t._v(" æ€»ç»“")]),t._v(" "),a("ul",[a("li",[t._v("mobx api ç®€å•ï¼Œæ ·æ¿ä»£ç å°‘")]),t._v(" "),a("li",[t._v("redux éœ€è¦æ³¨æ„çš„æŒºå¤šï¼Œmobx éœ€è¦å¯¹ä¾èµ–æ”¶é›†ç†è§£")]),t._v(" "),a("li",[t._v("Redux è§„èŒƒ stateï¼Œmobx ä¸æ‹…å¿ƒåµŒå¥—")]),t._v(" "),a("li",[t._v("æ€§èƒ½æ–¹é¢ã€‚è°ƒä¼˜è¿‡çš„ redux é¡¹ç›®åŸºæœ¬è·Ÿ mobx æ‰“å¹³ã€‚")]),t._v(" "),a("li",[t._v("Effectã€‚saga å°è£…çš„ä¸šåŠ¡åœºæ™¯ï¼Œmobx æ²¡æœ‰ä¸­é—´ä»¶ï¼Œä¸å®¹æ˜“æ‹“å±•ã€‚")]),t._v(" "),a("li",[t._v("ç¤¾åŒºã€‚redux å®Œèƒœ\né€‰å“ªä¸ªå‘¢ï¼Ÿ")])]),t._v(" "),a("h1",{attrs:{id:"æœ€å"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æœ€å"}},[t._v("#")]),t._v(" æœ€å")]),t._v(" "),a("p",[t._v("è™½ç„¶é€šè¿‡ä¸€äº› redux çš„é—®é¢˜ï¼Œå»å¼•å‡º mobxï¼Œä½†æ˜¯å¹¶ä¸æ„å‘³ç€ redux å°±æ˜¯ä¸å¥½çš„ã€‚é¦–å…ˆæ¯ä¸ªæŠ€æœ¯æ ˆéƒ½æ˜¯æ ¹æ®åœºæ™¯ï¼Œå›¢é˜Ÿéœ€è¦å»é€‰æ‹©çš„ã€‚å¦å¤–ï¼Œæ‰‹åŠ¨è°ƒä¼˜çš„å·¥ä½œä¸ä»…ä»…æ˜¯ view å±‚çš„åº”ç”¨ä¸­ï¼Œè€Œæ˜¯æ•´ä¸ªå‰ç«¯çš„é“¾è·¯éƒ½æ˜¯éœ€è¦çš„ï¼Œä¹Ÿæ²¡æœ‰å®Œç¾çš„ã€ä¸€åŠ³æ°¸é€¸çš„æ–¹æ¡ˆï¼Œåªæœ‰è‡ªå·±ä¸æ–­çš„å­¦ä¹ å’Œä¼˜åŒ–ï¼Œæ‰èƒ½æ›´å¿«çš„è¿›æ­¥ã€‚")]),t._v(" "),a("h1",{attrs:{id:"æ‹“å±•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ‹“å±•"}},[t._v("#")]),t._v(" æ‹“å±•")]),t._v(" "),a("p",[t._v("https://www.youtube.com/watch?v=xsSnOQynTHs redux è‡ªæ­¤å¼€å§‹ç«")]),t._v(" "),a("p",[t._v("https://zhuanlan.zhihu.com/p/25989654 conf MobX vs Redux")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/xufei/blog/issues/47",target:"_blank",rel:"noopener noreferrer"}},[t._v("xufei/blog#47"),a("OutboundLink")],1),t._v(" å•é¡µæ•°æ®æµæ–¹æ¡ˆæ¢ç´¢ï¼Œrxjs")]),t._v(" "),a("p",[t._v("#21 redux ä¸­é—´ä»¶")]),t._v(" "),a("p",[t._v("https://medium.com/@mweststrate/how-to-safely-use-react-context-b7e343eff076")])])}),[],!1,null,null,null);e.default=r.exports}}]);